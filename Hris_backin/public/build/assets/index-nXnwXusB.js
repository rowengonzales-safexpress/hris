import{F as v}from"./FRMSLayout-snJua142.js";import{_ as R}from"./CoreTable.vue_vue_type_style_index_0_lang-D8LkGZdJ.js";import{_ as F}from"./SectionTitleLineWithButton-CvP-kldM.js";import{_ as k}from"./CardBox-B8VuaoGy.js";import{_ as E}from"./FormField-Cnx0pd2b.js";import{_ as T}from"./FormControl-C_nPUmK8.js";import{_ as V}from"./BaseButton-YqB03AwT.js";import{_ as B}from"./BaseButtons--tE85GFf.js";import{_ as L}from"./AsideDrawer-DLoyHTrP.js";import{r as g}from"./@inertiajs-DE7H7qLl.js";import{E as A}from"./jspdf-aMcTLUx4.js";import"./jspdf-autotable-TLQB5wf7.js";import{_ as w}from"./app-VaUb3FJr.js";import{Q as c,K as h,y as _,J as r,H as a,D as i,L as p,x as q,M as P,B as U,C as N}from"./@vue-DhfKueGL.js";import"./SessionIdle.vue_vue_type_script_setup_true_lang-0Er72HTu.js";import"./AdminPanelNavbar-Bdvrohd_.js";import"./BaseIcon-BVVkr6PJ.js";import"./@mdi-Ds8bXjTD.js";import"./Dropdown-5dMGiR8k.js";import"./DropdownLink-Bo-pNtpR.js";import"./axios-ngrFHoWO.js";import"./Modal.vue_vue_type_script_setup_true_lang-DpTllPHL.js";import"./Footer-D5LPszYR.js";import"./moment-T1pcntrQ.js";import"./call-bind-apply-helpers-zm886y3p.js";import"./function-bind-CHqF18-c.js";import"./es-errors-CFxpeikN.js";import"./html2pdf.js-p1DVm4cu.js";import"./html2canvas-CBrSDip1.js";import"./pinia-DPcN--oA.js";import"./qs-DlAKVIfT.js";import"./side-channel-CCwe-Ttv.js";import"./object-inspect-CiOUnV34.js";import"./side-channel-list-BCqwI4KF.js";import"./side-channel-map-Bo135rTK.js";import"./get-intrinsic-DYXGad5I.js";import"./es-object-atoms-Ditt1eQ6.js";import"./math-intrinsics-Cv-yPkyD.js";import"./gopd-fcd2-aIC.js";import"./es-define-property-bDCdrV83.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-CQl1k7Za.js";import"./dunder-proto-tAQ_MH3o.js";import"./hasown-DwiY0sux.js";import"./call-bound-DTEBmFVe.js";import"./side-channel-weakmap-DvnJlOn0.js";import"./lodash-es-BU332SBD.js";import"./@babel-Dehwj3G0.js";import"./fflate-XZmX483V.js";import"./fast-png-CUrN0NP5.js";import"./iobuffer-DZ1zOcUT.js";import"./pako-B9FS3IR_.js";import"./lodash-B2PBWGQw.js";import"./laravel-vite-plugin-DEL3ZhID.js";const O={name:"LiquidationReport",components:{FRMSLayout:v,CoreTable:R,SectionTitleLineWithButton:F,CardBox:k,FormField:E,FormControl:T,BaseButton:V,BaseButtons:B,AsideDrawer:L},props:{liquidationData:{type:Array,default:()=>[]},filters:{type:Object,default:()=>({})},summary:{type:Object,default:()=>({})},sites:{type:Array,default:()=>[]}},data(){var e,l,n,u;return{filters:{date_from:((e=this.filters)==null?void 0:e.date_from)||"",date_to:((l=this.filters)==null?void 0:l.date_to)||"",site_id:((n=this.filters)==null?void 0:n.site_id)||"",status:((u=this.filters)==null?void 0:u.status)||""},tableHeader:[{key:"ref_num",label:"Reference No.",sortable:!0},{key:"employee",label:"Employee",sortable:!0},{key:"branch_name",label:"Site",sortable:!0},{key:"expense_amount",label:"Expense Amount",sortable:!0},{key:"date",label:"Date",sortable:!0},{key:"status",label:"Status",sortable:!0},{key:"description",label:"Description",sortable:!1}],openDrawer:!1,selectedRecord:{}}},computed:{averageExpense(){return this.summary.total_records===0?0:this.summary.total_expenses/this.summary.total_records},siteOptions(){return[{value:"",label:"All Sites"},...this.sites.map(e=>({value:e.id,label:e.branch_name}))]},statusOptions(){return[{value:"",label:"All Status"},{value:"P",label:"Pending"},{value:"A",label:"Approved"},{value:"R",label:"Rejected"}]}},methods:{applyFilters(){g.get(route("frms.reports.liquidation"),this.filters,{preserveState:!0,preserveScroll:!0})},formatCurrency(e){return e?parseFloat(e).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"},formatDate(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"2-digit"}):"N/A"},getStatusClass(e){return{P:"bg-yellow-100 text-yellow-800",A:"bg-green-100 text-green-800",R:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800"},getStatusText(e){return{P:"Pending",A:"Approved",R:"Rejected"}[e]||"Unknown"},openLink(e){this.selectedRecord=e,this.openDrawer=!0},viewDetails(){console.log("View full details for:",this.selectedRecord)},refreshData(){g.get(route("frms.reports.liquidation"),this.filters,{preserveState:!0,preserveScroll:!0})},exportSingleRecord(){console.log("Export single record:",this.selectedRecord)},exportToExcel(){const l=[["Reference No.","Employee","Site","Expense Amount","Date","Status","Description"].join(","),...this.liquidationData.map(o=>[o.ref_num||"",`"${o.first_name} ${o.last_name}"`,`"${o.branch_name||""}"`,o.expense_amount||0,this.formatDate(o.date),this.getStatusText(o.status),`"${o.description||"N/A"}"`].join(","))].join(`
`),n=new Blob([l],{type:"text/csv"}),u=window.URL.createObjectURL(n),t=document.createElement("a");t.href=u,t.download=`liquidation_report_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(u)},exportToPDF(){const e=new A;e.setFontSize(20),e.setFont("helvetica","bold"),e.text("SafExpress Finance System",105,20,{align:"center"}),e.setFontSize(16),e.setFont("helvetica","normal"),e.text("Liquidation Report",105,30,{align:"center"}),e.setFontSize(10),e.text(`Generated on: ${new Date().toLocaleDateString()}`,20,45);let l=55;if(e.setFontSize(12),e.setFont("helvetica","bold"),e.text("Report Filters:",20,l),l+=10,e.setFontSize(10),e.setFont("helvetica","normal"),this.filters.date_from||this.filters.date_to){const t=`${this.filters.date_from||"Start"} to ${this.filters.date_to||"End"}`;e.text(`Date Range: ${t}`,20,l),l+=8}if(this.filters.site_id){const t=this.sites.find(o=>o.id==this.filters.site_id);e.text(`Site: ${t?t.branch_name:"All Sites"}`,20,l),l+=8}this.filters.status&&(e.text(`Status: ${this.getStatusText(this.filters.status)}`,20,l),l+=8),l+=5,e.setFontSize(12),e.setFont("helvetica","bold"),e.text("Summary:",20,l),l+=10,e.setFontSize(10),e.setFont("helvetica","normal"),e.text(`Total Expenses: ₱${this.formatCurrency(this.summary.total_expenses)}`,20,l),l+=8,e.text(`Total Records: ${this.summary.total_records}`,20,l),l+=8,e.text(`Average Expense: ₱${this.formatCurrency(this.averageExpense)}`,20,l);const n=this.liquidationData.map(t=>[t.ref_num||"",`${t.first_name} ${t.last_name}`,t.branch_name||"",`₱${this.formatCurrency(t.expense_amount)}`,this.formatDate(t.date),this.getStatusText(t.status),t.description||"N/A"]);e.autoTable({head:[["Reference No.","Employee","Site","Expense Amount","Date","Status","Description"]],body:n,startY:l+15,styles:{fontSize:8,cellPadding:3},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},columnStyles:{0:{cellWidth:25},1:{cellWidth:30},2:{cellWidth:25},3:{cellWidth:25},4:{cellWidth:20},5:{cellWidth:20},6:{cellWidth:35}}});const u=e.internal.getNumberOfPages();for(let t=1;t<=u;t++)e.setPage(t),e.setFontSize(8),e.text(`Page ${t} of ${u}`,105,e.internal.pageSize.height-10,{align:"center"}),e.text("SafExpress Finance System - Liquidation Report",20,e.internal.pageSize.height-10);e.save(`liquidation_report_${new Date().toISOString().split("T")[0]}.pdf`)}}},z={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},j={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},W={class:"bg-purple-500 text-white p-4 rounded-lg"},M={class:"text-2xl font-bold"},H={class:"bg-blue-500 text-white p-4 rounded-lg"},I={class:"text-2xl font-bold"},G={class:"bg-green-500 text-white p-4 rounded-lg"},J={class:"text-2xl font-bold"},K={class:"font-bold text-purple-600"},Q={key:1,class:"text-gray-500 text-center py-8"};function Y(e,l,n,u,t,o){const f=c("BaseButton"),b=c("BaseButtons"),y=c("SectionTitleLineWithButton"),d=c("FormControl"),m=c("FormField"),x=c("CardBox"),S=c("CoreTable"),D=c("AsideDrawer"),C=c("FRMSLayout");return _(),h(C,null,{default:r(()=>[a(y,{icon:"mdiReceiptText",title:"Liquidation Report",main:""},{default:r(()=>[a(b,null,{default:r(()=>[a(f,{onClick:o.exportToExcel,icon:"mdiFileExcel",label:"Export Excel",color:"success",disabled:n.liquidationData.length===0,"rounded-full":"",small:""},null,8,["onClick","disabled"]),a(f,{onClick:o.exportToPDF,icon:"mdiFilePdf",label:"Export PDF",color:"danger",disabled:n.liquidationData.length===0,"rounded-full":"",small:""},null,8,["onClick","disabled"])]),_:1})]),_:1}),a(x,{class:"mb-6"},{default:r(()=>[i("div",z,[a(m,{label:"Date From"},{default:r(()=>[a(d,{type:"date",modelValue:t.filters.date_from,"onUpdate:modelValue":l[0]||(l[0]=s=>t.filters.date_from=s),onChange:o.applyFilters},null,8,["modelValue","onChange"])]),_:1}),a(m,{label:"Date To"},{default:r(()=>[a(d,{type:"date",modelValue:t.filters.date_to,"onUpdate:modelValue":l[1]||(l[1]=s=>t.filters.date_to=s),onChange:o.applyFilters},null,8,["modelValue","onChange"])]),_:1}),a(m,{label:"Site"},{default:r(()=>[a(d,{modelValue:t.filters.site_id,"onUpdate:modelValue":l[2]||(l[2]=s=>t.filters.site_id=s),options:o.siteOptions,onChange:o.applyFilters},null,8,["modelValue","options","onChange"])]),_:1}),a(m,{label:"Status"},{default:r(()=>[a(d,{modelValue:t.filters.status,"onUpdate:modelValue":l[3]||(l[3]=s=>t.filters.status=s),options:o.statusOptions,onChange:o.applyFilters},null,8,["modelValue","options","onChange"])]),_:1})]),i("div",j,[i("div",W,[l[8]||(l[8]=i("h5",{class:"text-sm font-medium opacity-90"},"Total Expenses",-1)),i("h3",M,"₱"+p(o.formatCurrency(n.summary.total_expenses)),1)]),i("div",H,[l[9]||(l[9]=i("h5",{class:"text-sm font-medium opacity-90"},"Total Records",-1)),i("h3",I,p(n.summary.total_records),1)]),i("div",G,[l[10]||(l[10]=i("h5",{class:"text-sm font-medium opacity-90"},"Average Expense",-1)),i("h3",J,"₱"+p(o.formatCurrency(o.averageExpense)),1)])])]),_:1}),a(x,{class:"flex-1","has-table":""},{default:r(()=>[n.liquidationData.length>0?(_(),h(S,{key:0,"table-rows":n.liquidationData,"table-header":t.tableHeader,"table-name":"Liquidation Report","searchable-fields":["ref_num","first_name","last_name","branch_name","description"],"is-paginated":!1,onOpenLink:o.openLink},{"table-action":r(()=>[a(b,null,{default:r(()=>[a(f,{icon:"mdiRefresh",title:"Refresh Data",color:"whiteDark",onClick:o.refreshData},null,8,["onClick"])]),_:1})]),status:r(({row:s})=>[i("span",{class:U([o.getStatusClass(s.status),"px-2 py-1 rounded-full text-xs font-medium"])},p(o.getStatusText(s.status)),3)]),expense_amount:r(({row:s})=>[i("span",K," ₱"+p(o.formatCurrency(s.expense_amount)),1)]),employee:r(({row:s})=>[i("div",null,[i("strong",null,p(s.first_name)+" "+p(s.last_name),1)])]),date:r(({row:s})=>[P(p(o.formatDate(s.date)),1)]),_:1},8,["table-rows","table-header","onOpenLink"])):(_(),q("div",Q," No liquidation records found. Adjust your filters to view data. "))]),_:1}),a(D,{title:"Liquidation Details","is-open":t.openDrawer,onCloseDrawer:l[7]||(l[7]=s=>t.openDrawer=!1),class:"shadow-lg shadow-purple-500/50"},{default:r(()=>[a(m,{label:"Reference No."},{default:r(()=>[a(d,{modelValue:t.selectedRecord.ref_num,"onUpdate:modelValue":l[4]||(l[4]=s=>t.selectedRecord.ref_num=s),disabled:!0},null,8,["modelValue"])]),_:1}),a(m,{label:"Employee"},{default:r(()=>[a(d,{"model-value":`${t.selectedRecord.first_name} ${t.selectedRecord.last_name}`,disabled:!0},null,8,["model-value"])]),_:1}),a(m,{label:"Site"},{default:r(()=>[a(d,{modelValue:t.selectedRecord.branch_name,"onUpdate:modelValue":l[5]||(l[5]=s=>t.selectedRecord.branch_name=s),disabled:!0},null,8,["modelValue"])]),_:1}),a(m,{label:"Expense Amount"},{default:r(()=>[a(d,{"model-value":`₱${o.formatCurrency(t.selectedRecord.expense_amount)}`,disabled:!0},null,8,["model-value"])]),_:1}),a(m,{label:"Date"},{default:r(()=>[a(d,{"model-value":o.formatDate(t.selectedRecord.date),disabled:!0},null,8,["model-value"])]),_:1}),a(m,{label:"Status"},{default:r(()=>[a(d,{"model-value":o.getStatusText(t.selectedRecord.status),disabled:!0},null,8,["model-value"])]),_:1}),a(m,{label:"Description"},{default:r(()=>[a(d,{modelValue:t.selectedRecord.description,"onUpdate:modelValue":l[6]||(l[6]=s=>t.selectedRecord.description=s),disabled:!0},null,8,["modelValue"])]),_:1}),a(b,{class:"mt-4"},{default:r(()=>[t.selectedRecord.status==="P"?(_(),h(f,{key:0,color:"info",onClick:o.viewDetails,label:"View Full Details",icon:"mdiEye"},null,8,["onClick"])):N("",!0),a(f,{color:"contrast",onClick:o.exportSingleRecord,label:"Export Record",icon:"mdiDownload"},null,8,["onClick"])]),_:1})]),_:1},8,["is-open"])]),_:1})}const Xe=w(O,[["render",Y],["__scopeId","data-v-92533bbf"]]);export{Xe as default};
