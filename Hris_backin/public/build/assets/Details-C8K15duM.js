import{u as M}from"./@inertiajs-DE7H7qLl.js";import{h as N}from"./moment-T1pcntrQ.js";import{a as k}from"./axios-ngrFHoWO.js";import{_ as V}from"./BaseButton-YqB03AwT.js";import{_ as $}from"./BaseButtons--tE85GFf.js";import{_ as n}from"./FormField-Cnx0pd2b.js";import{_ as d}from"./FormControl-C_nPUmK8.js";import{_ as E}from"./Checkbox-DBVwD7bY.js";import{r as v,b as g,w as I,x as u,y as c,D as a,H as o,J as s,F as R,z as A,C,L as p}from"./@vue-DhfKueGL.js";import"./qs-DlAKVIfT.js";import"./side-channel-CCwe-Ttv.js";import"./es-errors-CFxpeikN.js";import"./object-inspect-CiOUnV34.js";import"./call-bind-apply-helpers-zm886y3p.js";import"./function-bind-CHqF18-c.js";import"./side-channel-list-BCqwI4KF.js";import"./side-channel-map-Bo135rTK.js";import"./get-intrinsic-DYXGad5I.js";import"./es-object-atoms-Ditt1eQ6.js";import"./math-intrinsics-Cv-yPkyD.js";import"./gopd-fcd2-aIC.js";import"./es-define-property-bDCdrV83.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-CQl1k7Za.js";import"./dunder-proto-tAQ_MH3o.js";import"./hasown-DwiY0sux.js";import"./call-bound-DTEBmFVe.js";import"./side-channel-weakmap-DvnJlOn0.js";import"./lodash-es-BU332SBD.js";import"./html2pdf.js-p1DVm4cu.js";import"./html2canvas-CBrSDip1.js";import"./BaseIcon-BVVkr6PJ.js";import"./@mdi-Ds8bXjTD.js";import"./pinia-DPcN--oA.js";const L={class:"details-container"},P={class:"details-content"},Y={class:"detail-section"},H={class:"detail-section"},j={key:0,class:"store-table-container overflow-x-auto"},q={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},z={class:"px-6 py-4"},G={key:0,class:"flex flex-col items-center bg-green-200 px-2 py-2 rounded w-16"},J={class:"px-6 py-4"},O={class:"px-6 py-4"},W={class:"px-6 py-4"},K={class:"px-6 py-4"},Q={key:0,class:"flex flex-col items-center bg-green-50 px-2 py-2 rounded w-16"},X={class:"font-semibold text-lg text-green-700"},Z={class:"text-xs text-gray-600"},w={key:1,class:"text-sm text-gray-500"},D={class:"detail-section"},ee={class:"detail-section"},te={class:"flex items-center space-x-2 mb-3"},le={class:"details-actions"},Le={__name:"Details",props:{data:{type:Object,required:!0},trackingTypes:{type:Array,default:()=>[]},trackingStatuses:{type:Array,default:()=>[]},isNew:{type:Boolean,default:!1}},emits:["close","save","update","Manage","triggerTopRightButton"],setup(U,{emit:S}){const T=U,f=S,i=M({id:null,branch_id:"",tracking_number:"",reference_number:"",tracking_type_id:"",estimated_delivery_date:"",actual_delivery_date:"",current_status_id:"",current_location:"",priority_level:"",total_weight:"",total_volume:"",package_count:"",special_instructions:"",driver_id:"",helper_name:"",call_time:"",whse_in:"",loading_start:"",loading_end:"",whse_out:"",is_active:!0}),r=v({id:null,warehouse_id:"",tracking_number:"",reference_number:"",tracking_type:"",current_status:"",estimated_delivery_date:"",actual_delivery_date:"",current_location:"",priority_level:"",total_weight:"",total_volume:"",package_count:"",special_instructions:"",driver_id:"",helper_name:"",call_time:"",whse_in:"",loading_start:"",loading_end:"",whse_out:"",is_active:!0}),h=g(()=>r.value.estimated_delivery_date?N(r.value.estimated_delivery_date).format("MMMM DD, YYYY"):"-"),_=v([]);g(()=>r.value.current_location||"-"),v({}),g(()=>{const l={};return _.value.forEach(e=>{const t=e.city||"Unknown";l[t]||(l[t]=[]),e.Plateno&&!l[t].includes(e.Plateno)&&l[t].push(e.Plateno)}),l});const x=g(()=>{const l=[],e=new Map;return _.value.forEach((t,y)=>{const m=t.city||"Unknown";e.has(m)||e.set(m,[]),e.get(m).push({...t,originalIndex:y})}),e.forEach((t,y)=>{t.forEach((m,b)=>{l.push({...m,cityRowspan:b===0?t.length:0,cityCount:t.length,isFirstInCity:b===0})})}),l});I(()=>T.data,l=>{l&&(r.value={...l},i.id=l.id,i.branch_id=l.branch_id||"",i.tracking_number=l.tracking_number||"",i.reference_number=l.reference_number||"",i.tracking_type_id=l.tracking_type_id||"",i.estimated_delivery_date=l.estimated_delivery_date||"",i.actual_delivery_date=l.actual_delivery_date||"",i.current_status_id=l.current_status_id||"",i.current_location=l.current_location||"",i.priority_level=l.priority_level||"",i.total_weight=l.total_weight||"",i.total_volume=l.total_volume||"",i.package_count=l.package_count||"",i.special_instructions=l.special_instructions||"",i.driver_id=l.driver_id||"",i.helper_name=l.helper_name||"",i.call_time=l.call_time||"",i.whse_in=l.whse_in||"",i.loading_start=l.loading_start||"",i.loading_end=l.loading_end||"",i.whse_out=l.whse_out||"",i.is_active=l.is_active!==void 0?l.is_active:!0,l.id?(k.get(`/tracking/tracking-event/header/${l.id}`).then(e=>{const t=e.data||{};r.value={...r.value,...t},i.driver_id=t.driver_id??i.driver_id,i.call_time=t.call_time??i.call_time,i.whse_in=t.whse_in??i.whse_in,i.loading_start=t.loading_start??i.loading_start,i.loading_end=t.loading_end??i.loading_end,i.whse_out=t.whse_out??i.whse_out}).catch(e=>{console.error("Failed loading header details:",e)}),k.get(`/tracking/tracker/api/droptrip-summary/${l.id}`).then(e=>{_.value=e.data||[]}).catch(e=>{console.error("Failed loading droptrip summary:",e),_.value=[]})):_.value=[])},{immediate:!0});const F=()=>{f("close")},B=()=>{f("triggerTopRightButton","Manage",r.value)};return(l,e)=>(c(),u("div",L,[a("div",P,[a("div",Y,[o(n,{label:"Trackin Number"},{default:s(()=>[o(d,{readonly:"",name:"tracking_number",modelValue:r.value.tracking_number,"onUpdate:modelValue":e[0]||(e[0]=t=>r.value.tracking_number=t),type:"text"},null,8,["modelValue"])]),_:1}),o(n,{label:"Reference Number"},{default:s(()=>[o(d,{readonly:"",name:"reference_number",modelValue:r.value.reference_number,"onUpdate:modelValue":e[1]||(e[1]=t=>r.value.reference_number=t),type:"text"},null,8,["modelValue"])]),_:1}),o(n,{label:"Tracking Type"},{default:s(()=>[o(d,{readonly:"",name:"tracking_type",modelValue:r.value.tracking_type,"onUpdate:modelValue":e[2]||(e[2]=t=>r.value.tracking_type=t),type:"text"},null,8,["modelValue"])]),_:1}),o(n,{label:"Current Status"},{default:s(()=>[o(d,{readonly:"",name:"current_status",modelValue:r.value.current_status,"onUpdate:modelValue":e[3]||(e[3]=t=>r.value.current_status=t),type:"text"},null,8,["modelValue"])]),_:1})]),a("div",H,[e[11]||(e[11]=a("h3",{class:"section-title"},"Store Information",-1)),x.value.length>0?(c(),u("div",j,[a("table",q,[e[10]||(e[10]=a("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[a("tr",null,[a("th",{scope:"col",class:"px-6 py-3"},"Trip"),a("th",{scope:"col",class:"px-6 py-3"},"Client"),a("th",{scope:"col",class:"px-6 py-3"},"Consignee/Store"),a("th",{scope:"col",class:"px-6 py-3"},"Address"),a("th",{scope:"col",class:"px-6 py-3"},"Drops")])],-1)),a("tbody",null,[(c(!0),u(R,null,A(x.value,(t,y)=>(c(),u("tr",{key:y,class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[a("td",z,[t.isFirstInCity?(c(),u("div",G,[...e[9]||(e[9]=[a("span",{class:"font-semibold text-lg text-green-800"},"1",-1),a("span",{class:"text-xs text-gray-700"},"TRIP",-1)])])):C("",!0)]),a("td",J,p(t.Client||"-"),1),a("td",O,p(t.ClientStore),1),a("td",W,p(t.Address),1),a("td",K,[t.isFirstInCity?(c(),u("div",Q,[a("span",X,p(t.cityCount),1),a("span",Z,p(t.cityCount===1?"drop":"drops"),1)])):C("",!0)])]))),128))])])])):(c(),u("div",w,"No store information found for this event."))]),a("div",D,[e[12]||(e[12]=a("h3",{class:"section-title"},"Location & Delivery",-1)),o(n,{label:"Current Location"},{default:s(()=>[o(d,{name:"current_location",modelValue:r.value.current_location,"onUpdate:modelValue":e[4]||(e[4]=t=>r.value.current_location=t),type:"text"},null,8,["modelValue"])]),_:1}),o(n,{label:"Priority Level"},{default:s(()=>[o(d,{name:"priority_level",modelValue:r.value.priority_level,"onUpdate:modelValue":e[5]||(e[5]=t=>r.value.priority_level=t),type:"text"},null,8,["modelValue"])]),_:1}),o(n,{label:"Total Weight"},{default:s(()=>[o(d,{readonly:"",name:"total_weight",modelValue:h.value,"onUpdate:modelValue":e[6]||(e[6]=t=>h.value=t),type:"text"},null,8,["modelValue"])]),_:1})]),o(n,{label:"Special Instructions"},{default:s(()=>[o(d,{name:"special_instructions",modelValue:r.value.special_instructions,"onUpdate:modelValue":e[7]||(e[7]=t=>r.value.special_instructions=t),type:"textarea"},null,8,["modelValue"])]),_:1}),a("div",ee,[e[14]||(e[14]=a("h3",{class:"section-title"},"Status",-1)),a("label",te,[o(E,{checked:r.value.is_active,"onUpdate:checked":e[8]||(e[8]=t=>r.value.is_active=t),value:!0},null,8,["checked"]),e[13]||(e[13]=a("span",{class:"text-sm text-gray-700"},"Active",-1))])])]),a("div",le,[o($,null,{default:s(()=>[o(V,{icon:"mdinav",color:"info","rounded-full":"",small:"",label:"manage",onClick:B}),o(V,{icon:"mdiClose",color:"danger","rounded-full":"",small:"",label:"Cancel",onClick:F})]),_:1})])]))}};export{Le as default};
