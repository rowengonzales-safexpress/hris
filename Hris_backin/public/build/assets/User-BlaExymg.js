import{a as re,u as oe,r as ie}from"./@inertiajs-DE7H7qLl.js";import{s as ne}from"./service-CLgXUwp_.js";import{_ as de}from"./CardBox-B8VuaoGy.js";import{_ as ue}from"./CoreTable.vue_vue_type_style_index_0_lang-D8LkGZdJ.js";import{_ as me}from"./AsideDrawer-DLoyHTrP.js";import{_ as p}from"./FormField-Cnx0pd2b.js";import{_ as v}from"./FormControl-C_nPUmK8.js";import{_ as q}from"./BaseButtons--tE85GFf.js";import{_ as S}from"./BaseButton-YqB03AwT.js";import{a as L}from"./axios-ngrFHoWO.js";import{_ as pe}from"./SwalConfirm.vue_vue_type_script_setup_true_lang-DKkGdSL9.js";import{_ as ce}from"./Checkbox-DBVwD7bY.js";import{_ as k}from"./BaseIcon-BVVkr6PJ.js";import{r as b,b as d,o as fe,x as w,y as c,H as s,J as n,C as A,F as H,z as ve,L as D,I as i,D as r,M as C,B as g,A as _e,K}from"./@vue-DhfKueGL.js";import"./qs-DlAKVIfT.js";import"./side-channel-CCwe-Ttv.js";import"./es-errors-CFxpeikN.js";import"./object-inspect-CiOUnV34.js";import"./call-bind-apply-helpers-zm886y3p.js";import"./function-bind-CHqF18-c.js";import"./side-channel-list-BCqwI4KF.js";import"./side-channel-map-Bo135rTK.js";import"./get-intrinsic-DYXGad5I.js";import"./es-object-atoms-Ditt1eQ6.js";import"./math-intrinsics-Cv-yPkyD.js";import"./gopd-fcd2-aIC.js";import"./es-define-property-bDCdrV83.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-CQl1k7Za.js";import"./dunder-proto-tAQ_MH3o.js";import"./hasown-DwiY0sux.js";import"./call-bound-DTEBmFVe.js";import"./side-channel-weakmap-DvnJlOn0.js";import"./lodash-es-BU332SBD.js";/* empty css                                              */import"./app-VaUb3FJr.js";import"./jspdf-aMcTLUx4.js";import"./@babel-Dehwj3G0.js";import"./fflate-XZmX483V.js";import"./fast-png-CUrN0NP5.js";import"./iobuffer-DZ1zOcUT.js";import"./pako-B9FS3IR_.js";import"./lodash-B2PBWGQw.js";import"./pinia-DPcN--oA.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./@mdi-Ds8bXjTD.js";import"./html2pdf.js-p1DVm4cu.js";import"./html2canvas-CBrSDip1.js";import"./moment-T1pcntrQ.js";import"./SectionTitleLineWithButton-CvP-kldM.js";import"./Modal.vue_vue_type_script_setup_true_lang-DpTllPHL.js";const be={key:0,class:"mb-3 text-red-600 text-sm"},we={key:1,class:"mb-4"},he={class:"flex justify-between items-center mb-2"},ye={key:0,class:"text-gray-500 text-sm italic"},ge={key:2},xe={class:"mb-4 p-4 bg-blue-900/10 rounded-lg border border-blue-500/30"},Ve={class:"flex items-start"},ke={key:0,class:"mb-6 -mt-4 px-1"},Ce={class:"flex justify-between items-center mb-1"},Ue={class:"text-xs text-gray-500 dark:text-gray-400"},Ae={class:"h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden mb-2"},$e={class:"grid grid-cols-1 gap-1"},Se={class:"flex items-center"},Ee={class:"ml-2"},Sl={__name:"User",setup(Ne){const O=b([]),T=b([]),j=b([]),h=b(!1),u=b(!1),W=re(),t=oe({_token:W.props.csrf_token,id:null,name:"",first_name:"",last_name:"",email:"",user_type:"User",member_role:null,sitehead_user_id:null,branch_id:"",status:"A",password:"",password_confirmation:""}).transform(l=>{var e,a,o,y;return{...l,member_role:((e=l.member_role)==null?void 0:e.id)!==void 0?l.member_role.id:l.member_role,user_type:((a=l.user_type)==null?void 0:a.id)!==void 0?l.user_type.id:l.user_type,sitehead_user_id:((o=l.sitehead_user_id)==null?void 0:o.id)!==void 0?l.sitehead_user_id.id:l.sitehead_user_id,branch_id:((y=l.branch_id)==null?void 0:y.id)!==void 0?l.branch_id.id:l.branch_id}}),_=b([]);let U=ne();const B=b(!1),f=b(""),Z=d(()=>f.value==="Add"?"Add User":f.value==="Edit"?"Edit User":"User"),x=b(!1),E=d(()=>{const l=T.value.map(e=>({id:e.id,label:e.name}));return[{id:null,label:"Select Role"},...l]}),N=d(()=>[{id:"User",label:"User"},{id:"Admin",label:"Admin"}]),P=d(()=>{const l=O.value.map(e=>({id:e.id,label:e.name}));return[{id:null,label:"Select Immediate Head"},...l]}),F=d(()=>{const l=j.value.map(e=>({id:e.id,label:e.branch_name}));return[{id:null,label:"Select Branch"},...l]}),m=d(()=>{const l=t.password||"";return{length:l.length>=8,upper:/[A-Z]/.test(l),lower:/[a-z]/.test(l),number:/[0-9]/.test(l),special:/[!@#$%^&*]/.test(l)}}),I=d(()=>{const l=m.value;let e=0;return l.length&&e++,l.upper&&e++,l.lower&&e++,l.number&&e++,l.special&&e++,e}),J=d(()=>{const l=I.value;return l<=1?"Very Weak":l===2?"Weak":l===3?"Medium":l===4?"Strong":"Very Strong"}),R=d(()=>{const l=I.value;return l<=1?"text-red-500":l===2?"text-orange-500":l===3?"text-yellow-500":l===4?"text-blue-500":"text-green-600"}),G=d(()=>{const l=I.value;return l<=1?"bg-red-500":l===2?"bg-orange-500":l===3?"bg-yellow-500":l===4?"bg-blue-500":"bg-green-600"}),Q=d(()=>`${I.value/5*100}%`),z=d(()=>t.password&&t.password_confirmation&&t.password===t.password_confirmation),X=[{label:"Username",fieldName:"name",type:"link"},{label:"First Name",fieldName:"first_name"},{label:"Last Name",fieldName:"last_name"},{label:"Email",fieldName:"email"},{label:"Type",fieldName:"user_type"},{label:"Status",fieldName:"status",type:"activeinactive"}],M=async()=>{var l,e,a;u.value=!0;try{const[o,y,$]=await Promise.all([L.get("/frls/user/list"),L.get("/frls/role/list"),L.get("/frls/core-branch/list")]);O.value=((l=o==null?void 0:o.data)==null?void 0:l.data)??[],T.value=((e=y==null?void 0:y.data)==null?void 0:e.data)??[],j.value=((a=$==null?void 0:$.data)==null?void 0:a.data)??[]}catch(o){console.error("Error loading data:",o)}finally{u.value=!1}},Y=async l=>{var e;f.value="Edit",u.value=!0;try{const a=await L.get(`/frls/user/${l.id}`),o=(a==null?void 0:a.data)||l;t.id=o.id??l.id,t.name=o.name??l.name??"",t.first_name=o.first_name??l.first_name??"",t.last_name=o.last_name??l.last_name??"",t.email=o.email??l.email??"";const y=o.user_type??l.user_type??"User";t.user_type=N.value.find(V=>V.id===y)||N.value[0];const $=((e=o.role)==null?void 0:e.id)??o.member_role??l.member_role??null;t.member_role=E.value.find(V=>V.id===$)||E.value[0],t.status=o.status??"A";const ae=o.sitehead_user_id??l.sitehead_user_id??null;t.sitehead_user_id=P.value.find(V=>V.id==ae)||P.value[0];const se=o.branch_id??l.branch_id??null;t.branch_id=F.value.find(V=>V.id==se)||F.value[0],t.password="",t.password_confirmation="",x.value=!1,h.value=!0}finally{u.value=!1}},ee=()=>{f.value="Add",t.id=null,t.name="",t.first_name="",t.last_name="",t.email="",t.user_type=N.value[0],t.member_role=E.value[0],t.status="A",t.sitehead_user_id=P.value[0],t.branch_id=F.value[0],t.password="",t.password_confirmation="",x.value=!0,h.value=!0},le=async()=>{u.value=!0;try{f.value==="Edit"&&t.id?await new Promise((l,e)=>{t.put(`/frls/user/${t.id}`,{preserveScroll:!0,onSuccess:()=>{U.success("User updated"),l()},onError:a=>{_.value=Object.values(a||{});const o=_.value.length>0?_.value[0]:"Failed to update user";U.error(o),e(a)}})}):await new Promise((l,e)=>{t.post("/frls/user",{preserveScroll:!0,onSuccess:()=>{U.success("User created"),l()},onError:a=>{_.value=Object.values(a||{});const o=_.value.length>0?_.value[0]:"Failed to create user";U.error(o),e(a)}})}),await M(),h.value=!1}finally{u.value=!1}},te=async()=>{if(!t.id){h.value=!1;return}u.value=!0;try{await new Promise((l,e)=>{ie.delete(`/frls/user/${t.id}`,{preserveScroll:!0,onSuccess:()=>{U.success("User deleted"),l()},onError:a=>{_.value=Object.values(a||{}),U.error("Failed to delete user"),e(a)}})}),await M(),h.value=!1}finally{u.value=!1}};return fe(M),(l,e)=>(c(),w(H,null,[s(de,{class:"flex-1 p-6","has-table":""},{default:n(()=>[s(ue,{"table-rows":O.value,"table-header":X,"table-name":"Users","searchable-fields":"name,email,first_name,last_name","is-paginated":!0,loading:u.value,onOpenLink:Y},{"table-action":n(()=>[s(q,null,{default:n(()=>[s(S,{icon:"mdiFileDocumentPlus",disabled:u.value,color:"info","rounded-full":"",small:"",label:"Add",onClick:ee},null,8,["disabled"])]),_:1})]),_:1},8,["table-rows","loading"])]),_:1}),s(me,{title:Z.value,"is-open":h.value,onCloseDrawer:e[15]||(e[15]=a=>h.value=!1),class:"shadow-lg shadow-blue-500/50"},{default:n(()=>[_.value.length?(c(),w("div",be,[(c(!0),w(H,null,ve(_.value,(a,o)=>(c(),w("div",{key:o},D(a),1))),128))])):A("",!0),s(p,{label:"Username"},{default:n(()=>[s(v,{modelValue:i(t).name,"onUpdate:modelValue":e[0]||(e[0]=a=>i(t).name=a)},null,8,["modelValue"])]),_:1}),s(p,{label:"First Name"},{default:n(()=>[s(v,{modelValue:i(t).first_name,"onUpdate:modelValue":e[1]||(e[1]=a=>i(t).first_name=a)},null,8,["modelValue"])]),_:1}),s(p,{label:"Last Name"},{default:n(()=>[s(v,{modelValue:i(t).last_name,"onUpdate:modelValue":e[2]||(e[2]=a=>i(t).last_name=a)},null,8,["modelValue"])]),_:1}),s(p,{label:"Email"},{default:n(()=>[s(v,{modelValue:i(t).email,"onUpdate:modelValue":e[3]||(e[3]=a=>i(t).email=a),type:"email"},null,8,["modelValue"])]),_:1}),s(p,{label:"Immediate Head"},{default:n(()=>[s(v,{modelValue:i(t).sitehead_user_id,"onUpdate:modelValue":e[4]||(e[4]=a=>i(t).sitehead_user_id=a),options:P.value},null,8,["modelValue","options"])]),_:1}),s(p,{label:"User Type"},{default:n(()=>[s(v,{modelValue:i(t).user_type,"onUpdate:modelValue":e[5]||(e[5]=a=>i(t).user_type=a),options:N.value},null,8,["modelValue","options"])]),_:1}),s(p,{label:"Branch"},{default:n(()=>[s(v,{modelValue:i(t).branch_id,"onUpdate:modelValue":e[6]||(e[6]=a=>i(t).branch_id=a),options:F.value},null,8,["modelValue","options"])]),_:1}),s(p,{label:"Role"},{default:n(()=>[s(v,{modelValue:i(t).member_role,"onUpdate:modelValue":e[7]||(e[7]=a=>i(t).member_role=a),options:E.value},null,8,["modelValue","options"])]),_:1}),f.value==="Edit"?(c(),w("div",we,[r("div",he,[s(S,{type:"button",small:"",color:"info",outline:"",label:x.value?"Cancel":"Change Password",onClick:e[8]||(e[8]=a=>x.value=!x.value)},null,8,["label"])]),x.value?A("",!0):(c(),w("p",ye,"Leave blank to keep current password"))])):A("",!0),x.value?(c(),w("div",ge,[r("div",xe,[r("div",Ve,[s(k,{path:"mdiInformation",class:"text-blue-500 mr-2 mt-0.5",w:"w-5",h:"h-5"}),e[16]||(e[16]=r("div",{class:"text-sm text-gray-600 dark:text-gray-300"},[r("p",{class:"font-semibold mb-1"},"Password Requirements"),r("ul",{class:"list-disc pl-4 space-y-0.5 text-xs"},[r("li",null,"Must be at least 8 characters long"),r("li",null,"Must meet at least 3 of the following criteria:"),r("ul",{class:"list-disc pl-4 mt-0.5"},[r("li",null,"At least one uppercase letter (A-Z)"),r("li",null,"At least one lowercase letter (a-z)"),r("li",null,"At least one number (0-9)"),r("li",null,"At least one special character (!@#$%^&*)")])])],-1))])]),s(p,{label:"Password",required:f.value==="Add"},{default:n(()=>[s(v,{modelValue:i(t).password,"onUpdate:modelValue":e[9]||(e[9]=a=>i(t).password=a),type:"password",icon:"mdiKey"},null,8,["modelValue"])]),_:1},8,["required"]),(f.value==="Add"||i(t).password)&&i(t).password?(c(),w("div",ke,[r("div",Ce,[r("span",Ue,[e[17]||(e[17]=C("Password strength: ",-1)),r("span",{class:g(["font-bold",R.value])},D(J.value),3)])]),r("div",Ae,[r("div",{class:g(["h-full transition-all duration-300",G.value]),style:_e({width:Q.value})},null,6)]),r("div",$e,[r("div",{class:g(["flex items-center text-xs",m.value.length?"text-green-500":"text-red-500"])},[s(k,{path:m.value.length?"mdiCheck":"mdiClose",w:"w-3.5",h:"h-3.5",class:"mr-1"},null,8,["path"]),e[18]||(e[18]=C(" At least 8 characters ",-1))],2),r("div",{class:g(["flex items-center text-xs",m.value.upper?"text-green-500":"text-red-500"])},[s(k,{path:m.value.upper?"mdiCheck":"mdiClose",w:"w-3.5",h:"h-3.5",class:"mr-1"},null,8,["path"]),e[19]||(e[19]=C(" Uppercase letter (A-Z) ",-1))],2),r("div",{class:g(["flex items-center text-xs",m.value.lower?"text-green-500":"text-red-500"])},[s(k,{path:m.value.lower?"mdiCheck":"mdiClose",w:"w-3.5",h:"h-3.5",class:"mr-1"},null,8,["path"]),e[20]||(e[20]=C(" Lowercase letter (a-z) ",-1))],2),r("div",{class:g(["flex items-center text-xs",m.value.number?"text-green-500":"text-red-500"])},[s(k,{path:m.value.number?"mdiCheck":"mdiClose",w:"w-3.5",h:"h-3.5",class:"mr-1"},null,8,["path"]),e[21]||(e[21]=C(" Number (0-9) ",-1))],2),r("div",{class:g(["flex items-center text-xs",m.value.special?"text-green-500":"text-red-500"])},[s(k,{path:m.value.special?"mdiCheck":"mdiClose",w:"w-3.5",h:"h-3.5",class:"mr-1"},null,8,["path"]),e[22]||(e[22]=C(" Special character (!@#$%^&*) ",-1))],2)])])):A("",!0),s(p,{label:"Confirm Password",required:f.value==="Add"},{default:n(()=>[r("div",null,[s(v,{modelValue:i(t).password_confirmation,"onUpdate:modelValue":e[10]||(e[10]=a=>i(t).password_confirmation=a),type:"password",icon:"mdiKey"},null,8,["modelValue"]),i(t).password_confirmation?(c(),w("div",{key:0,class:g(["flex items-center text-xs mt-1",z.value?"text-green-500":"text-red-500"])},[s(k,{path:z.value?"mdiCheck":"mdiClose",w:"w-3.5",h:"h-3.5",class:"mr-1"},null,8,["path"]),C(" "+D(z.value?"Passwords match":"Passwords do not match"),1)],2)):A("",!0)])]),_:1},8,["required"])])):A("",!0),s(p,{label:"Status"},{default:n(()=>[r("div",Se,[s(ce,{checked:i(t).status==="A","onUpdate:checked":e[11]||(e[11]=a=>i(t).status=a?"A":"I")},null,8,["checked"]),r("span",Ee,D(i(t).status==="A"?"Active":"Inactive"),1)])]),_:1}),s(q,null,{default:n(()=>[s(S,{icon:"mdiContentSave",disabled:u.value,color:"info","rounded-full":"",small:"",label:"Save",onClick:le},null,8,["disabled"]),f.value==="Edit"?(c(),K(S,{key:0,icon:"mdiDelete",color:"danger","rounded-full":"",small:"",label:"Delete",onClick:e[12]||(e[12]=a=>B.value=!0)})):(c(),K(S,{key:1,icon:"mdiClose",color:"error","rounded-full":"",small:"",label:"Cancel",onClick:e[13]||(e[13]=a=>h.value=!1)}))]),_:1}),s(pe,{modelValue:B.value,"onUpdate:modelValue":e[14]||(e[14]=a=>B.value=a),type:"warning",title:"Delete Record",text:"Are you sure you want to delete this record?",onConfirm:te},null,8,["modelValue"])]),_:1},8,["title","is-open"])],64))}};export{Sl as default};
