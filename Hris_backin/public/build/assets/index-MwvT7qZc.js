import{W}from"./WeeklyTaskLayout-DXTc1r_Z.js";import{h as $}from"./@inertiajs-DE7H7qLl.js";import{a as I}from"./axios-ngrFHoWO.js";import{h as u}from"./moment-T1pcntrQ.js";import{r as g,b as d,w as N,o as j,x as n,y as l,H as b,I as F,J as V,D as r,C as x,L as m,F as f,z as k,B as v}from"./@vue-DhfKueGL.js";import"./SessionIdle.vue_vue_type_script_setup_true_lang-0Er72HTu.js";import"./AdminPanelNavbar-Bdvrohd_.js";import"./BaseIcon-BVVkr6PJ.js";import"./@mdi-Ds8bXjTD.js";import"./app-VaUb3FJr.js";import"./jspdf-aMcTLUx4.js";import"./@babel-Dehwj3G0.js";import"./fflate-XZmX483V.js";import"./fast-png-CUrN0NP5.js";import"./iobuffer-DZ1zOcUT.js";import"./pako-B9FS3IR_.js";import"./lodash-B2PBWGQw.js";import"./call-bind-apply-helpers-zm886y3p.js";import"./function-bind-CHqF18-c.js";import"./es-errors-CFxpeikN.js";import"./pinia-DPcN--oA.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./html2pdf.js-p1DVm4cu.js";import"./html2canvas-CBrSDip1.js";import"./qs-DlAKVIfT.js";import"./side-channel-CCwe-Ttv.js";import"./object-inspect-CiOUnV34.js";import"./side-channel-list-BCqwI4KF.js";import"./side-channel-map-Bo135rTK.js";import"./get-intrinsic-DYXGad5I.js";import"./es-object-atoms-Ditt1eQ6.js";import"./math-intrinsics-Cv-yPkyD.js";import"./gopd-fcd2-aIC.js";import"./es-define-property-bDCdrV83.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-CQl1k7Za.js";import"./dunder-proto-tAQ_MH3o.js";import"./hasown-DwiY0sux.js";import"./call-bound-DTEBmFVe.js";import"./side-channel-weakmap-DvnJlOn0.js";import"./lodash-es-BU332SBD.js";import"./Dropdown-5dMGiR8k.js";import"./DropdownLink-Bo-pNtpR.js";import"./Modal.vue_vue_type_script_setup_true_lang-DpTllPHL.js";import"./FormField-Cnx0pd2b.js";import"./FormControl-C_nPUmK8.js";import"./BaseButton-YqB03AwT.js";const z={class:"bg-white dark:bg-gray-800 shadow sm:rounded-lg p-6"},E={class:"flex items-start justify-between gap-4"},P={class:"mt-1 text-sm text-gray-600 dark:text-gray-400"},U={class:"font-medium"},q={key:0,class:"ml-2"},A={class:"mt-4"},J={class:"grid grid-cols-7 gap-2 text-xs font-medium text-gray-600 dark:text-gray-300"},G={class:"mt-2 grid grid-cols-7 gap-2"},K={class:"flex items-start justify-between"},Q={class:"text-sm font-semibold text-gray-800 dark:text-gray-100"},R={key:0,class:"text-[11px] px-1.5 py-0.5 rounded-full border border-gray-200 dark:border-slate-700 text-gray-700 dark:text-gray-200 bg-white/70 dark:bg-slate-900/40"},X={class:"mt-auto flex items-center justify-end"},Jt={__name:"index",setup(Z){const s=g(u().startOf("month")),c=g(!1),p=g({}),_=d(()=>s.value.format("MMMM YYYY")),M=d(()=>s.value.clone().startOf("isoWeek").startOf("day")),Y=d(()=>s.value.clone().endOf("month").endOf("isoWeek").startOf("day")),w=d(()=>["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]),D=d(()=>{const e=[],t=M.value.clone();for(;t.isSameOrBefore(Y.value,"day");){const a=t.format("YYYY-MM-DD"),o=p.value[a]||{total:0,hit:0,miss:0};e.push({key:a,date:t.clone(),inMonth:t.isSame(s.value,"month"),meta:o}),t.add(1,"day")}return e}),C=e=>{const t=String((e==null?void 0:e.status)||"").toUpperCase().trim(),a=String((e==null?void 0:e.remarks)||"").toUpperCase().trim();return{isMiss:t==="MISS"||a==="MISS",isHit:t==="HIT"||a==="HIT"}},S=e=>{const t={};for(const a of e||[]){const o=u(a==null?void 0:a.taskdate);if(!o.isValid())continue;const i=o.format("YYYY-MM-DD");t[i]||(t[i]={total:0,hit:0,miss:0}),t[i].total+=1;const h=C(a);h.isMiss&&(t[i].miss+=1),h.isHit&&(t[i].hit+=1)}return t},y=async()=>{var e;c.value=!0;try{const t=s.value.clone().startOf("month").format("YYYY-MM-DD"),a=s.value.clone().endOf("month").format("YYYY-MM-DD"),o=await I.get("/weekly-task-schedule/api/filter-vsc",{params:{start_date:t,end_date:a},headers:{Accept:"application/json"}}),i=((e=o==null?void 0:o.data)==null?void 0:e.dailyTasks)||[];p.value=S(i)}catch{p.value={}}finally{c.value=!1}},T=()=>{s.value=s.value.clone().subtract(1,"month").startOf("month")},O=()=>{s.value=s.value.clone().add(1,"month").startOf("month")},B=e=>{var t;return(t=e==null?void 0:e.date)==null?void 0:t.isSame(u(),"day")},H=e=>{const t=`relative w-full aspect-square rounded-lg border p-2 flex flex-col ${B(e)?"ring-2 ring-indigo-500 ring-offset-2 ring-offset-white dark:ring-offset-gray-800":""}`;return e.inMonth?e.meta.miss>0?`${t} border-red-300 bg-red-50 dark:bg-red-900/20 dark:border-red-900/40`:e.meta.hit>0?`${t} border-green-300 bg-green-50 dark:bg-green-900/20 dark:border-green-900/40`:e.meta.total>0?`${t} border-gray-300 bg-gray-50 dark:bg-slate-800/40 dark:border-slate-700`:`${t} border-gray-200 dark:border-slate-700`:`${t} opacity-40 dark:opacity-30 border-gray-200 dark:border-slate-700`},L=e=>e.meta.miss>0?"bg-red-600":e.meta.hit>0?"bg-green-600":e.meta.total>0?"bg-gray-400":"bg-transparent";return N(()=>s.value.format("YYYY-MM"),()=>y()),j(()=>{y()}),(e,t)=>(l(),n(f,null,[b(F($),{title:"Calendar"}),b(W,null,{default:V(()=>[r("div",z,[r("div",E,[r("div",null,[t[0]||(t[0]=r("h2",{class:"text-xl font-semibold text-gray-800 dark:text-gray-200"}," Weekly Task Calendar ",-1)),r("div",P,[r("span",U,m(_.value),1),c.value?(l(),n("span",q,"Loadingâ€¦")):x("",!0)])]),r("div",{class:"flex items-center gap-2"},[r("button",{type:"button",class:"px-3 py-1.5 text-sm rounded border border-gray-300 dark:border-slate-700 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-slate-700",onClick:T}," Prev "),r("button",{type:"button",class:"px-3 py-1.5 text-sm rounded border border-gray-300 dark:border-slate-700 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-slate-700",onClick:O}," Next ")])]),t[1]||(t[1]=r("div",{class:"mt-4 flex flex-wrap items-center gap-4 text-sm"},[r("div",{class:"flex items-center gap-2 text-gray-700 dark:text-gray-200"},[r("span",{class:"h-2.5 w-2.5 rounded-full bg-green-600"}),r("span",null,"Hit")]),r("div",{class:"flex items-center gap-2 text-gray-700 dark:text-gray-200"},[r("span",{class:"h-2.5 w-2.5 rounded-full bg-red-600"}),r("span",null,"Miss")]),r("div",{class:"flex items-center gap-2 text-gray-700 dark:text-gray-200"},[r("span",{class:"h-2.5 w-2.5 rounded-full bg-gray-400"}),r("span",null,"Task")])],-1)),r("div",A,[r("div",J,[(l(!0),n(f,null,k(w.value,a=>(l(),n("div",{key:a,class:"px-2 py-1"},m(a),1))),128))]),r("div",G,[(l(!0),n(f,null,k(D.value,a=>(l(),n("div",{key:a.key,class:v(H(a))},[r("div",K,[r("div",Q,m(a.date.date()),1),a.meta.total>0?(l(),n("div",R,m(a.meta.total),1)):x("",!0)]),r("div",X,[r("span",{class:v(["h-2.5 w-2.5 rounded-full",L(a)])},null,2)])],2))),128))])])])]),_:1})],64))}};export{Jt as default};
