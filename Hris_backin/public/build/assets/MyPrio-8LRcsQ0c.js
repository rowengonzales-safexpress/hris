import{i as ae,r as k,b as le,w as ge,o as ve,x as d,y as n,H as l,I as r,J as m,D as s,L as i,F as y,z as h,O as $,B as N,K as W,C as M,N as V,M as p,Z as oe,P as U}from"./@vue-DhfKueGL.js";import{a as be,u as R,r as q,h as _e}from"./@inertiajs-DE7H7qLl.js";import{W as xe}from"./WeeklyTaskLayout-DXTc1r_Z.js";import{_ as z}from"./Modal.vue_vue_type_script_setup_true_lang-DpTllPHL.js";import{P as re}from"./PrimaryButton-EMOXWF2N.js";import{_ as G}from"./SecondaryButton.vue_vue_type_script_setup_true_lang-DfE7tAAa.js";import{_ as b}from"./FormField-Cnx0pd2b.js";import{_ as D}from"./FormControl-C_nPUmK8.js";import{_}from"./InputError.vue_vue_type_script_setup_true_lang-D55GOIOg.js";import{_ as he}from"./BaseIcon-BVVkr6PJ.js";import{_ as w}from"./BaseButton-YqB03AwT.js";import{_ as we}from"./CardBox-B8VuaoGy.js";import{a as J}from"./axios-ngrFHoWO.js";import{h as C}from"./moment-T1pcntrQ.js";import{l as Ce}from"./lodash-B2PBWGQw.js";import"./qs-DlAKVIfT.js";import"./side-channel-CCwe-Ttv.js";import"./es-errors-CFxpeikN.js";import"./object-inspect-CiOUnV34.js";import"./call-bind-apply-helpers-zm886y3p.js";import"./function-bind-CHqF18-c.js";import"./side-channel-list-BCqwI4KF.js";import"./side-channel-map-Bo135rTK.js";import"./get-intrinsic-DYXGad5I.js";import"./es-object-atoms-Ditt1eQ6.js";import"./math-intrinsics-Cv-yPkyD.js";import"./gopd-fcd2-aIC.js";import"./es-define-property-bDCdrV83.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-CQl1k7Za.js";import"./dunder-proto-tAQ_MH3o.js";import"./hasown-DwiY0sux.js";import"./call-bound-DTEBmFVe.js";import"./side-channel-weakmap-DvnJlOn0.js";import"./lodash-es-BU332SBD.js";import"./SessionIdle.vue_vue_type_script_setup_true_lang-0Er72HTu.js";import"./AdminPanelNavbar-Bdvrohd_.js";import"./app-VaUb3FJr.js";import"./jspdf-aMcTLUx4.js";import"./@babel-Dehwj3G0.js";import"./fflate-XZmX483V.js";import"./fast-png-CUrN0NP5.js";import"./iobuffer-DZ1zOcUT.js";import"./pako-B9FS3IR_.js";import"./pinia-DPcN--oA.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./@mdi-Ds8bXjTD.js";import"./html2pdf.js-p1DVm4cu.js";import"./html2canvas-CBrSDip1.js";import"./Dropdown-5dMGiR8k.js";import"./DropdownLink-Bo-pNtpR.js";const Te={class:"mb-4"},Se={class:"text-xl font-semibold text-gray-800 dark:text-gray-100"},$e={class:"flex justify-between items-center mb-6"},Me={key:0,class:"flex justify-center items-center p-10 bg-gray-50 rounded-lg"},Ve={key:1,class:"space-y-4"},De={class:"bg-gray-50 dark:bg-slate-800 dark:text-gray-100 p-4 rounded-t-lg flex justify-between items-center border-b dark:border-slate-700"},Ye=["onClick"],je={class:"font-semibold text-gray-800 dark:text-gray-100"},Pe={class:"flex items-center space-x-2"},Ee={class:"p-4 dark:bg-slate-900 dark:text-gray-100"},Ae={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Be={class:"font-bold"},He={class:"font-normal text-gray-700 dark:text-gray-200"},Ne={class:"font-bold"},Ue={class:"font-normal text-gray-700 dark:text-gray-200"},qe={class:"font-bold"},Le={class:"font-normal text-gray-700 dark:text-gray-200"},Oe={class:"font-bold"},Fe={class:"font-normal text-gray-700 dark:text-gray-200"},Ie={class:"font-bold"},We={class:"font-normal text-gray-700 dark:text-gray-200"},Re={class:"font-bold"},ze={class:"font-normal text-gray-700 dark:text-gray-200"},Ge={class:"font-bold"},Je={class:"font-normal text-gray-700 dark:text-gray-200"},Ke={class:"font-bold"},Ze={class:"font-normal text-gray-700 dark:text-gray-200"},Qe={class:"font-bold"},Xe={class:"font-normal text-gray-700 dark:text-gray-200"},et={class:"p-6"},tt={class:"text-lg font-medium text-gray-900 mb-4"},st=["value"],at=["value"],lt=["value"],ot=["value"],rt={class:"grid grid-cols-2 gap-4"},nt={class:"flex justify-end mt-6"},dt={class:"p-6"},it={class:"flex space-x-2 mb-4"},ut={key:0,class:"text-center py-4"},mt={key:1,class:"space-y-2"},ct={class:"flex items-center flex-1"},pt=["checked","onChange"],ft=["onClick"],kt=["onClick"],yt={key:0,class:"mt-4"},gt={class:"space-y-2 mt-2 pl-4 border-l-2 border-gray-200 dark:border-gray-700"},vt={class:"flex items-center flex-1"},bt=["checked","onChange"],_t=["onClick"],xt=["onClick"],ht={class:"mt-6 flex justify-end"},wt={class:"p-6"},Ct={class:"flex justify-end"},hs={__name:"MyPrio",props:{tasks:Object,filters:Object,sites:Array},setup(Y){const v=Y,T=be(),j=ae("$swal");ae("$toastr");const L=(a,e,t)=>{if(j&&typeof j.fire=="function")return typeof a=="string"?j.fire(a,e,t):j.fire(a);const c=typeof window<"u"?window.Swal:null;if(c&&typeof c.fire=="function")return typeof a=="string"?c.fire(a,e,t):c.fire(a);if(typeof a=="string")return alert([a,e].filter(Boolean).join(`
`)),Promise.resolve({isConfirmed:!0});{const ye=confirm(a.text||a.title||"Are you sure?");return Promise.resolve({isConfirmed:ye})}},O=k({query:v.filters.query||"",start_date:v.filters.start_date||"",end_date:v.filters.end_date||""}),x=k(!1),A=k(!1),P=k(!1);k(!1);const F=k(!1),I=k([]),g=k(null),S=k(!1),K=k(""),o=R({dailytask_id:null,site:"",user_id:T.props.auth.user.id,tasktype:"",plandate:"",planenddate:"",enddates:"",startdate:"",enddate:"",remarks:"",status:"",project:"",taskdate:"",status_task:0}),u=R({id:null,dailytask_id:null,task_name:"",status:0}),f=R({dailytask_id:null,startdate:"",remarks:"",status:""}),E=k([]),ne=a=>{const e=E.value.find(t=>t.id==a);return e?e.name:a},B=k(!1),de=le(()=>I.value.filter(a=>a.status===0)),H=le(()=>I.value.filter(a=>a.status===1));ge(O,Ce.debounce(a=>{q.get(route("weekly-task-schedule.index"),a,{preserveState:!0,preserveScroll:!0})},300),{deep:!0});const ie=()=>{S.value=!1,o.reset(),o.clearErrors(),x.value=!0},ue=a=>{S.value=!0,o.reset(),o.clearErrors(),o.dailytask_id=a.dailytask_id,o.site=a.site_name;const e=v.sites.find(t=>t.branch_name===a.site_name);o.site=e?e.id:a.site,o.tasktype=a.tasktype,o.plandate=C(a.plandate).format("YYYY-MM-DDTHH:mm"),o.planenddate=C(a.planenddate).format("YYYY-MM-DDTHH:mm"),o.project=a.project,K.value=C(a.taskdate).format("MMMM D, YYYY"),x.value=!0},me=()=>{S.value?o.put(route("weekly-task-schedule.update",o.dailytask_id),{onSuccess:()=>{x.value=!1}}):o.post(route("weekly-task-schedule.store"),{onSuccess:()=>{x.value=!1}})},ce=a=>{j.fire({title:"Are you sure?",text:"You wanna Drop this Todo?",icon:"warning",showCancelButton:!0}).then(e=>{e.isConfirmed&&q.delete(route("weekly-task-schedule.destroy",a))})},Z=async a=>{F.value=!0;try{const e=await J.get(route("weekly-task-schedule.getTask",a));I.value=e.data}catch(e){console.error("Error fetching tasks:",e)}finally{F.value=!1}},Q=a=>{g.value=a,u.dailytask_id=a.dailytask_id,u.task_name="",u.id=null,A.value=!0,Z(a.dailytask_id)},X=a=>{u.id=a.id,u.dailytask_id=a.dailytask_id,u.task_name=a.task_name,u.status=a.status,u.clearErrors()},ee=()=>{if(!(u.task_name||"").trim()){L("Todo name is required","","warning");return}const e=u.dailytask_id;u.post(route("weekly-task-schedule.addTask"),{onSuccess:()=>{u.reset("task_name","id","status"),u.status=0,Z(e)},preserveScroll:!0})},te=a=>{q.delete(route("weekly-task-schedule.deleteTask",a),{preserveScroll:!0})},se=a=>{u.id=a.id,u.dailytask_id=a.dailytask_id,u.task_name=a.task_name,u.status=a.status===1?0:1,ee()},pe=a=>{J.get(route("weekly-task-schedule.getTask",a.dailytask_id)).then(e=>{if(!e.data||e.data.length===0){L("Warning!","No todos found. Please add todo before starting your task.","warning");return}L({title:"Are you sure?",text:"You want to start your todo now?",icon:"warning",showCancelButton:!0}).then(t=>{t.isConfirmed&&q.put(route("weekly-task-schedule.onhandler",a.dailytask_id),{status:"On Going"})})})},fe=a=>{f.dailytask_id=a.dailytask_id,f.startdate=a.startdate,f.remarks="",P.value=!0},ke=()=>{if(!f.remarks)return;const a=v.tasks.data.find(t=>t.dailytask_id==f.dailytask_id),e=C(a.taskdate).isSame(C(),"day");f.status=e?"HIT":"MISS",f.put(route("weekly-task-schedule.onhandler",f.dailytask_id),{onSuccess:()=>{P.value=!1}})};return ve(()=>{const a=T.props&&T.props.flash?T.props.flash:{};if(a.open_task_id){const e=v.tasks&&v.tasks.data?v.tasks.data.find(t=>t.dailytask_id==a.open_task_id):null;e&&Q(e)}a.success,J.get(route("weekly-task-schedule.tasktypes"),{headers:{Accept:"application/json"}}).then(e=>{E.value=e.data.tasktypes||[]}).catch(()=>{E.value=[]})}),(a,e)=>(n(),d(y,null,[l(r(_e),{title:"Weekly Task Dashboard"}),l(xe,null,{default:m(()=>[l(we,{class:"flex-1 p-6","has-table":""},{default:m(()=>[s("div",Te,[s("h2",Se,i(r(T).props.auth.user.first_name)+" "+i(r(T).props.auth.user.last_name)+" - My Prio ",1),e[17]||(e[17]=s("div",{class:"mt-2 border-b border-gray-200 dark:border-slate-700"},null,-1))]),s("div",$e,[l(w,{onClick:ie,color:"info",icon:"mdiPlus",label:"New Task"}),l(D,{modelValue:O.value.query,"onUpdate:modelValue":e[0]||(e[0]=t=>O.value.query=t),placeholder:"Search...",class:"w-64",clearable:!0},null,8,["modelValue"])]),Y.tasks.data.length===0?(n(),d("div",Me,[...e[18]||(e[18]=[s("div",{class:"text-center"},[s("img",{src:"/img/no task.jpg",alt:"No Task",class:"mx-auto h-48 opacity-50 mb-4"}),s("p",{class:"text-gray-500"},"No tasks found.")],-1)])])):(n(),d("div",Ve,[(n(!0),d(y,null,h(Y.tasks.data,t=>(n(),d("div",{key:t.dailytask_id,class:"border rounded-lg shadow-sm dark:border-slate-700"},[s("div",De,[s("div",{class:"flex items-center space-x-3 cursor-pointer",onClick:c=>g.value=g.value===t.dailytask_id?null:t.dailytask_id},[s("i",{class:N(["fa fa-chevron-right transition-transform duration-200 text-gray-400",{"rotate-90":g.value===t.dailytask_id}])},null,2),l(he,{path:"mdiCalendar",class:"text-red-500",size:20}),s("div",je,i(r(C)(t.taskdate).format("MMMM D, YYYY"))+" - "+i(t.site_name),1)],8,Ye),s("div",Pe,[!t.startdate&&t.tasktype!=="HOLIDAY"?(n(),W(w,{key:0,icon:"mdiWatch",label:"Start",onClick:V(c=>pe(t),["stop"]),border:!1,color:"",class:"bg-green-600 hover:bg-green-700 text-white dark:bg-green-600"},null,8,["onClick"])):M("",!0),t.startdate&&!t.enddate&&t.tasktype!=="HOLIDAY"?(n(),W(w,{key:1,icon:"mdiWatch",label:"End",onClick:V(c=>fe(t),["stop"]),border:!1,color:"",class:"bg-red-600 hover:bg-red-700 text-white dark:bg-red-600"},null,8,["onClick"])):M("",!0),l(w,{icon:"mdiFormatListBulleted",onClick:V(c=>Q(t),["stop"]),border:!1,color:"",class:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 dark:bg-blue-600"},null,8,["onClick"])])]),$(s("div",Ee,[s("div",Ae,[s("div",null,[s("p",Be,[e[19]||(e[19]=p("Site: ",-1)),s("span",He,i(t.site_name),1)]),s("p",Ne,[e[20]||(e[20]=p("Planned Date: ",-1)),s("span",Ue,i(t.plandate),1)]),s("p",qe,[e[21]||(e[21]=p("Planned End Date: ",-1)),s("span",Le,i(t.planenddate),1)]),l(w,{label:"Edit",icon:"mdiBookEditOutline",onClick:V(c=>ue(t),["stop"]),color:"info"},null,8,["onClick"])]),s("div",null,[s("p",Oe,[e[22]||(e[22]=p("Start Date: ",-1)),s("span",Fe,i(r(C)(t.startdate).format("MMMM D, YYYY , HH:mm A")),1)]),s("p",Ie,[e[23]||(e[23]=p("Accomplished Date: ",-1)),s("span",We,i(t.enddate),1)]),s("p",Re,[e[24]||(e[24]=p("Type: ",-1)),s("span",ze,i(ne(t.tasktype)),1)])]),s("div",null,[s("p",Ge,[e[25]||(e[25]=p("Status: ",-1)),s("span",Je,i(t.status),1)]),s("p",Ke,[e[26]||(e[26]=p("Attachment: ",-1)),s("span",Ze,i(t.attachment),1)]),s("p",Qe,[e[27]||(e[27]=p("Remarks: ",-1)),s("span",Xe,i(t.remarks),1)]),!t.startdate&&!t.enddate?(n(),W(w,{key:0,label:"Drop",icon:"mdiDeleteOutline",onClick:V(c=>ce(t.dailytask_id),["stop"]),color:"danger"},null,8,["onClick"])):M("",!0)])])],512),[[oe,g.value===t.dailytask_id]])]))),128))])),e[28]||(e[28]=s("div",{class:"mt-6"},null,-1))]),_:1}),l(z,{show:x.value,closeable:!1,onClose:e[9]||(e[9]=t=>x.value=!1)},{default:m(()=>[s("div",et,[s("h2",tt,i(S.value?`Edit My Task on ${K.value}`:"Create New Task"),1),s("form",{onSubmit:V(me,["prevent"]),class:"space-y-4"},[S.value?(n(),d(y,{key:0},[l(b,{label:"Select a Site:"},{default:m(()=>[$(s("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>r(o).site=t),id:"site",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm w-full"},[e[29]||(e[29]=s("option",{value:""},"Select Site",-1)),(n(!0),d(y,null,h(Y.sites,t=>(n(),d("option",{key:t.id,value:t.id},i(t.branch_name),9,st))),128))],512),[[U,r(o).site]]),l(_,{message:r(o).errors.site,class:"mt-2"},null,8,["message"])]),_:1}),l(b,{label:"Type"},{default:m(()=>[$(s("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>r(o).tasktype=t),id:"tasktype",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm w-full"},[e[30]||(e[30]=s("option",{value:""},"Select Type",-1)),(n(!0),d(y,null,h(E.value,t=>(n(),d("option",{key:t.id,value:t.id},i(t.name),9,at))),128))],512),[[U,r(o).tasktype]]),l(_,{message:r(o).errors.tasktype,class:"mt-2"},null,8,["message"])]),_:1})],64)):(n(),d(y,{key:1},[l(b,{label:"Site"},{default:m(()=>[$(s("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>r(o).site=t),id:"site",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm w-full"},[e[31]||(e[31]=s("option",{value:""},"Select Site",-1)),(n(!0),d(y,null,h(Y.sites,t=>(n(),d("option",{key:t.id,value:t.id},i(t.branch_name),9,lt))),128))],512),[[U,r(o).site]]),l(_,{message:r(o).errors.site,class:"mt-2"},null,8,["message"])]),_:1}),l(b,{label:"Task Type"},{default:m(()=>[$(s("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>r(o).tasktype=t),id:"tasktype",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm w-full"},[e[32]||(e[32]=s("option",{value:""},"Select Type",-1)),(n(!0),d(y,null,h(E.value,t=>(n(),d("option",{key:t.id,value:t.id},i(t.name),9,ot))),128))],512),[[U,r(o).tasktype]]),l(_,{message:r(o).errors.tasktype,class:"mt-2"},null,8,["message"])]),_:1}),l(b,{label:"Project / Description"},{default:m(()=>[l(D,{modelValue:r(o).project,"onUpdate:modelValue":e[5]||(e[5]=t=>r(o).project=t),required:""},null,8,["modelValue"]),l(_,{message:r(o).errors.project,class:"mt-2"},null,8,["message"])]),_:1}),s("div",rt,[l(b,{label:"Plan Start Date"},{default:m(()=>[l(D,{modelValue:r(o).plandate,"onUpdate:modelValue":e[6]||(e[6]=t=>r(o).plandate=t),type:"datetime-local",required:""},null,8,["modelValue"]),l(_,{message:r(o).errors.plandate,class:"mt-2"},null,8,["message"])]),_:1}),l(b,{label:"Plan End Date"},{default:m(()=>[l(D,{modelValue:r(o).planenddate,"onUpdate:modelValue":e[7]||(e[7]=t=>r(o).planenddate=t),type:"datetime-local",required:""},null,8,["modelValue"]),l(_,{message:r(o).errors.planenddate,class:"mt-2"},null,8,["message"])]),_:1})])],64)),s("div",nt,[l(G,{onClick:e[8]||(e[8]=t=>x.value=!1),class:"mr-3"},{default:m(()=>[...e[33]||(e[33]=[p("Cancel",-1)])]),_:1}),l(re,{class:N({"opacity-25":r(o).processing}),disabled:r(o).processing},{default:m(()=>[p(i(S.value?"submit":"Save"),1)]),_:1},8,["class","disabled"])])],32)])]),_:1},8,["show"]),l(z,{show:A.value,closeable:!1,onClose:e[13]||(e[13]=t=>A.value=!1)},{default:m(()=>[s("div",dt,[e[37]||(e[37]=s("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Todo List ",-1)),s("div",it,[l(D,{modelValue:r(u).task_name,"onUpdate:modelValue":e[10]||(e[10]=t=>r(u).task_name=t),placeholder:"New Todo...",class:"w-full",clearable:!0},null,8,["modelValue"]),l(w,{icon:r(u).id?"mdiPen":"mdiPlus",onClick:ee,disabled:r(u).processing},{default:m(()=>[p(i(r(u).id?"Edit":"Add"),1)]),_:1},8,["icon","disabled"])]),F.value?(n(),d("div",ut,"Loading...")):(n(),d("ul",mt,[(n(!0),d(y,null,h(de.value,t=>(n(),d("li",{key:t.id,class:"flex justify-between items-center p-2 bg-gray-50 dark:bg-slate-800 rounded"},[s("div",ct,[g.value&&g.value.startdate?(n(),d("input",{key:0,type:"checkbox",checked:t.status,onChange:c=>se(t),class:"mr-2 rounded text-blue-600 focus:ring-blue-500"},null,40,pt)):M("",!0),s("span",{onClick:c=>X(t),class:N(["cursor-pointer hover:text-blue-600 dark:hover:text-blue-400",{"line-through text-gray-400":t.status}])},i(t.task_name),11,ft)]),s("button",{onClick:c=>te(t.id),class:"text-red-500 hover:text-red-700"},[...e[34]||(e[34]=[s("i",{class:"fa fa-times"},null,-1)])],8,kt)]))),128)),H.value.length>0?(n(),d("div",yt,[s("button",{onClick:e[11]||(e[11]=t=>B.value=!B.value),class:"flex items-center text-sm font-medium text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},[s("i",{class:N(["fa mr-2",B.value?"fa-chevron-down":"fa-chevron-right"])},null,2),p(" Completed ("+i(H.value.length)+") ",1)])])):M("",!0),$(s("div",gt,[(n(!0),d(y,null,h(H.value,t=>(n(),d("li",{key:t.id,class:"flex justify-between items-center p-2 bg-gray-50 dark:bg-slate-800 rounded opacity-75"},[s("div",vt,[g.value&&g.value.startdate?(n(),d("input",{key:0,type:"checkbox",checked:t.status,onChange:c=>se(t),class:"mr-2 rounded text-blue-600 focus:ring-blue-500"},null,40,bt)):M("",!0),s("span",{onClick:c=>X(t),class:"cursor-pointer hover:text-blue-600 dark:hover:text-blue-400 line-through text-gray-400"},i(t.task_name),9,_t)]),s("button",{onClick:c=>te(t.id),class:"text-red-500 hover:text-red-700"},[...e[35]||(e[35]=[s("i",{class:"fa fa-times"},null,-1)])],8,xt)]))),128))],512),[[oe,B.value&&H.value.length>0]])])),s("div",ht,[l(G,{onClick:e[12]||(e[12]=t=>A.value=!1)},{default:m(()=>[...e[36]||(e[36]=[p("Close",-1)])]),_:1})])])]),_:1},8,["show"]),l(z,{show:P.value,closeable:!1,onClose:e[16]||(e[16]=t=>P.value=!1)},{default:m(()=>[s("div",wt,[e[40]||(e[40]=s("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," End Task Remarks ",-1)),l(b,{label:"Remarks"},{default:m(()=>[l(D,{modelValue:r(f).remarks,"onUpdate:modelValue":e[14]||(e[14]=t=>r(f).remarks=t),required:""},null,8,["modelValue"]),l(_,{message:r(f).errors.remarks,class:"mt-2"},null,8,["message"])]),_:1}),s("div",Ct,[l(G,{onClick:e[15]||(e[15]=t=>P.value=!1),class:"mr-3"},{default:m(()=>[...e[38]||(e[38]=[p("Cancel",-1)])]),_:1}),l(re,{onClick:ke,disabled:r(f).processing},{default:m(()=>[...e[39]||(e[39]=[p("Submit",-1)])]),_:1},8,["disabled"])])])]),_:1},8,["show"])]),_:1})],64))}};export{hs as default};
