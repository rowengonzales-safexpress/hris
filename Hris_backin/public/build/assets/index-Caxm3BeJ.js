import{W as Z}from"./WeeklyTaskLayout-DXTc1r_Z.js";import{a as ee,h as te}from"./@inertiajs-DE7H7qLl.js";import{a as L}from"./axios-ngrFHoWO.js";import{h as B}from"./moment-T1pcntrQ.js";import{_ as se}from"./FormControl-C_nPUmK8.js";import{r as n,b as _,o as ae,Q as re,x as a,y as r,H as x,I as oe,J as le,D as s,C as u,L as i,F as k,z as S,B as G,M as Y}from"./@vue-DhfKueGL.js";import"./SessionIdle.vue_vue_type_script_setup_true_lang-0Er72HTu.js";import"./AdminPanelNavbar-Bdvrohd_.js";import"./BaseIcon-BVVkr6PJ.js";import"./@mdi-Ds8bXjTD.js";import"./app-VaUb3FJr.js";import"./jspdf-aMcTLUx4.js";import"./@babel-Dehwj3G0.js";import"./fflate-XZmX483V.js";import"./fast-png-CUrN0NP5.js";import"./iobuffer-DZ1zOcUT.js";import"./pako-B9FS3IR_.js";import"./lodash-B2PBWGQw.js";import"./call-bind-apply-helpers-zm886y3p.js";import"./function-bind-CHqF18-c.js";import"./es-errors-CFxpeikN.js";import"./pinia-DPcN--oA.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./html2pdf.js-p1DVm4cu.js";import"./html2canvas-CBrSDip1.js";import"./qs-DlAKVIfT.js";import"./side-channel-CCwe-Ttv.js";import"./object-inspect-CiOUnV34.js";import"./side-channel-list-BCqwI4KF.js";import"./side-channel-map-Bo135rTK.js";import"./get-intrinsic-DYXGad5I.js";import"./es-object-atoms-Ditt1eQ6.js";import"./math-intrinsics-Cv-yPkyD.js";import"./gopd-fcd2-aIC.js";import"./es-define-property-bDCdrV83.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-CQl1k7Za.js";import"./dunder-proto-tAQ_MH3o.js";import"./hasown-DwiY0sux.js";import"./call-bound-DTEBmFVe.js";import"./side-channel-weakmap-DvnJlOn0.js";import"./lodash-es-BU332SBD.js";import"./Dropdown-5dMGiR8k.js";import"./DropdownLink-Bo-pNtpR.js";import"./Modal.vue_vue_type_script_setup_true_lang-DpTllPHL.js";import"./FormField-Cnx0pd2b.js";import"./BaseButton-YqB03AwT.js";const de={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ie={class:"bg-white dark:bg-gray-800 shadow sm:rounded-lg p-6"},ne={class:"flex items-center justify-between gap-3"},ue={class:"text-sm text-gray-500 dark:text-gray-400"},ce={class:"mt-4"},me={key:0,class:"mt-4 text-sm text-red-600 dark:text-red-400"},ye={key:1,class:"mt-4"},ge={key:2,class:"mt-4"},ve={class:"space-y-2"},pe=["onClick"],_e={class:"font-medium text-gray-800 dark:text-gray-200"},xe={key:0,class:"text-sm text-gray-600 dark:text-gray-400"},ke={key:0,class:"mt-4 flex items-center justify-between"},he=["disabled"],fe={class:"text-xs text-gray-500 dark:text-gray-400"},be=["disabled"],we={class:"bg-white dark:bg-gray-800 shadow sm:rounded-lg p-6 lg:col-span-2"},Me={class:"flex items-start justify-between gap-4"},Te={class:"mt-1 text-sm text-gray-600 dark:text-gray-400"},Ce={key:0},Ne={key:1},Se={key:2},Ye={key:0,class:"mt-4 text-sm text-red-600 dark:text-red-400"},Ue={key:1,class:"mt-6"},Pe={key:2,class:"mt-6 max-h-[70vh] overflow-y-auto pr-2 space-y-6"},je={key:0,class:"flex justify-center items-center p-10 bg-gray-50 dark:bg-slate-900/30 rounded-lg"},De={class:"flex items-center justify-between"},Ie={class:"text-sm font-semibold text-gray-700 dark:text-gray-300"},Le={class:"text-xs text-gray-500 dark:text-gray-400"},Be=["onClick"],Ve={class:"min-w-0 text-left"},Ae={class:"font-semibold text-gray-800 dark:text-gray-200 truncate"},Ee={class:"mt-1 text-xs text-gray-600 dark:text-gray-400"},Fe={key:0},Ge={key:1},Oe={key:2},We={class:"flex items-center gap-3 shrink-0"},Qe={class:"text-gray-500 dark:text-gray-400"},$e={key:0,class:"p-4 bg-white dark:bg-gray-800"},ze={class:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm"},qe={class:"text-gray-700 dark:text-gray-300"},He={class:"text-gray-700 dark:text-gray-300"},Je={class:"text-gray-700 dark:text-gray-300"},Re={class:"text-gray-700 dark:text-gray-300"},Ke={class:"mt-4"},Xe={key:0,class:"mt-2 text-sm text-red-600 dark:text-red-400"},Ze={key:1,class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},et={key:2,class:"mt-2"},tt={key:0,class:"text-sm text-gray-600 dark:text-gray-400"},st={key:1,class:"space-y-2"},at={class:"text-sm text-gray-800 dark:text-gray-200"},rt={class:"text-xs text-gray-600 dark:text-gray-400"},V=10,Zt={__name:"index",setup(ot){ee();const A=n(""),y=n([]),U=n(""),P=n(!1),h=n(""),c=n(1),f=n(null),E=_(()=>y.value.find(t=>t.id===f.value)||null),j=n(""),D=n(""),b=n([]),I=n(!1),w=n(""),v=n(null),m=n({}),p=n({}),g=n({}),M=_(()=>{const t=String(U.value||"").toLowerCase().trim();return t?y.value.filter(e=>String(e.full_name||"").toLowerCase().includes(t)):y.value}),T=_(()=>{const t=M.value.length;return Math.max(1,Math.ceil(t/V))}),O=_(()=>{const e=(Math.min(Math.max(c.value,1),T.value)-1)*V;return M.value.slice(e,e+V)}),W=_(()=>{const t=new Map;for(const d of b.value||[]){const l=d.taskdate?B(d.taskdate).format("YYYY-MM-DD"):"unknown";t.has(l)||t.set(l,[]),t.get(l).push(d)}return Array.from(t.keys()).sort((d,l)=>d.localeCompare(l)).map(d=>({key:d,label:d==="unknown"?"No date":B(d,"YYYY-MM-DD").format("dddd, MMMM D, YYYY"),tasks:t.get(d)||[]}))}),C=t=>{if(!t)return"";const e=B(t);return e.isValid()?e.format("MM/DD/YYYY hh:mm A"):String(t)},Q=t=>{const e=String((t==null?void 0:t.status)||"").toUpperCase().trim(),d=String((t==null?void 0:t.remarks)||"").toUpperCase().trim();return e==="MISS"||d==="MISS"},$=t=>{const e=String((t==null?void 0:t.status)||"").toUpperCase().trim();return e==="ON GOING"||e==="ONGOING"},z=t=>Q(t)?"bg-red-600 text-white border-red-700":$(t)?"bg-yellow-400 text-gray-900 border-yellow-500":"bg-white dark:bg-gray-900 border-gray-200 dark:border-slate-700 text-gray-700 dark:text-gray-300",q=async()=>{var t,e,d;P.value=!0,h.value="";try{const l=await L.get(route("weekly-task-schedule.teamtask.users"),{headers:{Accept:"application/json"}});A.value=((e=(t=l.data)==null?void 0:t.branch)==null?void 0:e.name)||"",y.value=((d=l.data)==null?void 0:d.users)||[],c.value=1,!f.value&&y.value.length>0&&await F(y.value[0].id)}catch{y.value=[],h.value="Failed to load team users."}finally{P.value=!1}},H=async t=>{var e,d,l;I.value=!0,w.value="",v.value=null,m.value={},p.value={},g.value={};try{const o=await L.get(route("weekly-task-schedule.teamtask.week",{user:t}),{headers:{Accept:"application/json"}});j.value=((e=o.data)==null?void 0:e.start)||"",D.value=((d=o.data)==null?void 0:d.end)||"",b.value=((l=o.data)==null?void 0:l.tasks)||[]}catch{b.value=[],w.value="Failed to load weekly tasks."}finally{I.value=!1}},F=async t=>{f.value=t,await H(t)},J=()=>{c.value=Math.max(1,c.value-1)},R=()=>{c.value=Math.min(T.value,c.value+1)},K=()=>{c.value=1},X=async t=>{const e=t==null?void 0:t.dailytask_id;if(e&&(v.value=v.value===e?null:e,v.value===e&&!Array.isArray(m.value[e]))){p.value={...p.value,[e]:!0},g.value={...g.value,[e]:""};try{const d=await L.get(route("weekly-task-schedule.getTask",e),{headers:{Accept:"application/json"}});m.value={...m.value,[e]:d.data||[]}}catch{m.value={...m.value,[e]:[]},g.value={...g.value,[e]:"Failed to load todos."}}finally{p.value={...p.value,[e]:!1}}}};return ae(()=>{q()}),(t,e)=>{const d=re("SkeletonLoader");return r(),a(k,null,[x(oe(te),{title:"Team Task"}),x(Z,null,{default:le(()=>[s("div",de,[s("div",ie,[s("div",ne,[e[1]||(e[1]=s("h2",{class:"text-xl font-semibold text-gray-800 dark:text-gray-200"}," Team ",-1)),s("div",ue," Branch: "+i(A.value||"-"),1)]),s("div",ce,[x(se,{modelValue:U.value,"onUpdate:modelValue":[e[0]||(e[0]=l=>U.value=l),K],placeholder:"Search user...",class:"w-full",clearable:!0},null,8,["modelValue"])]),h.value?(r(),a("div",me,i(h.value),1)):u("",!0),P.value?(r(),a("div",ye,[x(d,{type:"side-menu","item-count":8})])):(r(),a("div",ge,[s("div",ve,[(r(!0),a(k,null,S(O.value,l=>(r(),a("button",{key:l.id,type:"button",class:G(["w-full text-left px-3 py-2 rounded border dark:border-slate-700 hover:bg-gray-50 dark:hover:bg-slate-700/40 transition",f.value===l.id?"bg-blue-50 dark:bg-slate-700 border-blue-200 dark:border-slate-600":"bg-white dark:bg-gray-800"]),onClick:o=>F(l.id)},[s("div",_e,i(l.full_name||l.first_name+" "+l.last_name),1)],10,pe))),128)),M.value.length===0?(r(),a("div",xe," No users found. ")):u("",!0)]),M.value.length>0?(r(),a("div",ke,[s("button",{type:"button",class:"px-3 py-1 text-sm rounded border dark:border-slate-700 text-gray-700 dark:text-gray-200 disabled:opacity-50",disabled:c.value<=1,onClick:J}," Prev ",8,he),s("div",fe," Page "+i(c.value)+" / "+i(T.value),1),s("button",{type:"button",class:"px-3 py-1 text-sm rounded border dark:border-slate-700 text-gray-700 dark:text-gray-200 disabled:opacity-50",disabled:c.value>=T.value,onClick:R}," Next ",8,be)])):u("",!0)]))]),s("div",we,[s("div",Me,[s("div",null,[e[2]||(e[2]=s("h2",{class:"text-xl font-semibold text-gray-800 dark:text-gray-200"}," Weekly Tasks ",-1)),s("div",Te,[E.value?(r(),a("span",Ce,i(E.value.full_name),1)):(r(),a("span",Ne,"Select a user")),j.value&&D.value?(r(),a("span",Se," • "+i(j.value)+" to "+i(D.value),1)):u("",!0)])])]),w.value?(r(),a("div",Ye,i(w.value),1)):u("",!0),I.value?(r(),a("div",Ue,[x(d,{type:"card","item-count":6,columns:1})])):(r(),a("div",Pe,[b.value.length===0?(r(),a("div",je,[...e[3]||(e[3]=[s("div",{class:"text-center"},[s("p",{class:"text-gray-500 dark:text-gray-400"},"No tasks found for this week.")],-1)])])):u("",!0),(r(!0),a(k,null,S(W.value,l=>(r(),a("div",{key:l.key,class:"space-y-3"},[s("div",De,[s("div",Ie,i(l.label),1),s("div",Le,i(l.tasks.length)+" task(s) ",1)]),(r(!0),a(k,null,S(l.tasks,o=>(r(),a("div",{key:o.dailytask_id,class:"border rounded-lg dark:border-slate-700 overflow-hidden"},[s("button",{type:"button",class:"w-full flex items-center justify-between gap-4 p-4 bg-gray-50 dark:bg-slate-800/60 hover:bg-gray-100 dark:hover:bg-slate-800 transition",onClick:N=>X(o)},[s("div",Ve,[s("div",Ae,i(o.project||"Untitled task"),1),s("div",Ee,[o.site_name?(r(),a("span",Fe,i(o.site_name),1)):u("",!0),o.plandate?(r(),a("span",Ge," • Plan: "+i(C(o.plandate)),1)):u("",!0),o.planenddate?(r(),a("span",Oe," - "+i(C(o.planenddate)),1)):u("",!0)])]),s("div",We,[s("span",{class:G(["text-xs px-2 py-1 rounded border",z(o)])},i(o.status||"Pending"),3),s("span",Qe,i(v.value===o.dailytask_id?"▲":"▼"),1)])],8,Be),v.value===o.dailytask_id?(r(),a("div",$e,[s("div",ze,[s("div",qe,[e[4]||(e[4]=s("span",{class:"font-semibold"},"Start:",-1)),Y(" "+i(C(o.startdate)||"-"),1)]),s("div",He,[e[5]||(e[5]=s("span",{class:"font-semibold"},"End:",-1)),Y(" "+i(C(o.enddate)||"-"),1)]),s("div",Je,[e[6]||(e[6]=s("span",{class:"font-semibold"},"Remarks:",-1)),Y(" "+i(o.remarks||"-"),1)]),s("div",Re,[e[7]||(e[7]=s("span",{class:"font-semibold"},"Task ID:",-1)),Y(" "+i(o.dailytask_id),1)])]),s("div",Ke,[e[8]||(e[8]=s("div",{class:"text-sm font-semibold text-gray-800 dark:text-gray-200"}," Todos ",-1)),g.value[o.dailytask_id]?(r(),a("div",Xe,i(g.value[o.dailytask_id]),1)):u("",!0),p.value[o.dailytask_id]?(r(),a("div",Ze," Loading todos... ")):(r(),a("div",et,[(m.value[o.dailytask_id]||[]).length===0?(r(),a("div",tt," No todos found. ")):(r(),a("div",st,[(r(!0),a(k,null,S(m.value[o.dailytask_id],N=>(r(),a("div",{key:N.id,class:"flex items-center justify-between gap-3 p-3 rounded border dark:border-slate-700 bg-gray-50 dark:bg-slate-900/30"},[s("div",at,i(N.task_name),1),s("div",rt,i(N.status||"-"),1)]))),128))]))]))])])):u("",!0)]))),128))]))),128))]))])])]),_:1})],64)}}};export{Zt as default};
