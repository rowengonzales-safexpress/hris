import{b as h,r as n,w as Z,K as J,y as i,J as y,H as v,x as r,C as M,D as t,L as a,F as T,z as R,M as x,N as k,A as K}from"./@vue-DhfKueGL.js";import{F as P}from"./FRMSLayout-snJua142.js";import{_ as Q}from"./SectionTitleLineWithButton-CvP-kldM.js";import{_ as G}from"./BaseButtons--tE85GFf.js";import{_ as tt}from"./BaseButton-YqB03AwT.js";import{_ as et}from"./CardBox-B8VuaoGy.js";import{_ as st}from"./CoreTable.vue_vue_type_style_index_0_lang-D8LkGZdJ.js";import{r as ot}from"./@inertiajs-DE7H7qLl.js";import{_ as at}from"./Modal.vue_vue_type_script_setup_true_lang-DpTllPHL.js";import{a as nt}from"./axios-ngrFHoWO.js";import"./SessionIdle.vue_vue_type_script_setup_true_lang-0Er72HTu.js";import"./AdminPanelNavbar-Bdvrohd_.js";import"./BaseIcon-BVVkr6PJ.js";import"./@mdi-Ds8bXjTD.js";import"./app-VaUb3FJr.js";import"./jspdf-aMcTLUx4.js";import"./@babel-Dehwj3G0.js";import"./fflate-XZmX483V.js";import"./fast-png-CUrN0NP5.js";import"./iobuffer-DZ1zOcUT.js";import"./pako-B9FS3IR_.js";import"./lodash-B2PBWGQw.js";import"./call-bind-apply-helpers-zm886y3p.js";import"./function-bind-CHqF18-c.js";import"./es-errors-CFxpeikN.js";import"./pinia-DPcN--oA.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./html2pdf.js-p1DVm4cu.js";import"./html2canvas-CBrSDip1.js";import"./qs-DlAKVIfT.js";import"./side-channel-CCwe-Ttv.js";import"./object-inspect-CiOUnV34.js";import"./side-channel-list-BCqwI4KF.js";import"./side-channel-map-Bo135rTK.js";import"./get-intrinsic-DYXGad5I.js";import"./es-object-atoms-Ditt1eQ6.js";import"./math-intrinsics-Cv-yPkyD.js";import"./gopd-fcd2-aIC.js";import"./es-define-property-bDCdrV83.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-CQl1k7Za.js";import"./dunder-proto-tAQ_MH3o.js";import"./hasown-DwiY0sux.js";import"./call-bound-DTEBmFVe.js";import"./side-channel-weakmap-DvnJlOn0.js";import"./lodash-es-BU332SBD.js";import"./Dropdown-5dMGiR8k.js";import"./DropdownLink-Bo-pNtpR.js";import"./FormField-Cnx0pd2b.js";import"./FormControl-C_nPUmK8.js";import"./Footer-D5LPszYR.js";import"./moment-T1pcntrQ.js";const it={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},lt={class:"p-2"},rt={class:"p-2"},ut={class:"p-2"},ct={class:"mt-6"},dt={class:"p-2"},mt={class:"mt-4"},pt={class:"overflow-x-auto border rounded"},ft={class:"min-w-full text-sm"},vt={class:"px-4 py-2"},xt={class:"px-4 py-2"},_t={class:"px-4 py-2"},bt={class:"px-4 py-2 text-right"},ht={class:"px-4 py-2 text-right"},yt={class:"px-4 py-2 text-right"},gt={class:"border-t"},wt={class:"px-4 py-2 text-right font-bold"},Dt={class:"mt-6"},At={class:"overflow-x-auto border rounded"},kt={class:"min-w-full text-sm"},Ft={class:"px-4 py-2"},qt={class:"px-4 py-2"},Nt={class:"px-4 py-2"},Lt={class:"px-4 py-2 text-right"},$t={class:"px-4 py-2 text-right"},Ct={class:"px-4 py-2"},St={class:"px-4 py-2"},Mt=["onClick"],Tt=["src"],Rt={key:1},Bt={class:"mt-8 space-y-3"},Ot={class:"ml-2"},Vt={class:"ml-2"},Xt={key:0},Yt={class:"ml-2"},jt={class:"mt-4"},Et=["src"],zt=.5,It=4,ze={__name:"Reviewpage",props:{form:{type:Object,default:()=>({})},summary:{type:Object,default:()=>({})}},setup(u){const d=u;h(()=>{var s;const e=(s=d.form)==null?void 0:s.status_request;return e==="FA"?"For Approval":e==="FD"?"For Disbursement":e==="FL"?"For Liquidation":e==="A"?"Approved":e==="C"?"Closed":e==="X"?"Canceled":e||""}),h(()=>{var s;const e=(s=d.form)==null?void 0:s.user;return e?`${e.first_name??""} ${e.last_name??""}`.trim():""});const B=h(()=>{var e;return Array.isArray((e=d.form)==null?void 0:e.items)?d.form.items:[]});h(()=>B.value.map(e=>{var s;return{account_code_title:e.account_code_title,description:e.description,frequency:((s=e.frequency)==null?void 0:s.description)??"",qty:e.qty,unit_price_text:`₱${m(e.unit_price)}`,amount_text:`₱${m(e.amount)}`}}));const O=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"2-digit"}):"",V=()=>{ot.visit(route("frms.review.index"))},m=e=>Number(e||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),_=e=>e?parseFloat(e).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00",L=n(!1),X=n([]),Y=n(0),j=[{label:"Description",fieldName:"description"},{label:"OR No.",fieldName:"or_no"},{label:"Amount",fieldName:"amount"},{label:"Expense Amount",fieldName:"expense_amount"},{label:"Variance",fieldName:"variance"}],$=n(!1),g=n({form:{},items:[],liquidation:[],disbursement:null}),C=h(()=>{var e;return Math.abs(Number(((e=d.summary)==null?void 0:e.variance_total)||0))}),F=n(!1),q=n(""),E=e=>{q.value=e,F.value=!0},S=()=>{F.value=!1,q.value="",w.value=1,p.value=0,f.value=0,c.value=!1},w=n(1),z=e=>{const s=e.deltaY<0?.1:-.1,l=w.value+s;w.value=Math.min(It,Math.max(zt,l))},p=n(0),f=n(0),c=n(!1),D=n(0),A=n(0),I=e=>{c.value=!0,D.value=e.clientX-p.value,A.value=e.clientY-f.value},U=e=>{c.value&&(p.value=e.clientX-D.value,f.value=e.clientY-A.value)},N=()=>{c.value=!1},H=e=>{const s=e.touches[0];c.value=!0,D.value=s.clientX-p.value,A.value=s.clientY-f.value},W=e=>{const s=e.touches[0];c.value&&(p.value=s.clientX-D.value,f.value=s.clientY-A.value)};return Z(()=>d.form,async e=>{if(e){$.value=!0;try{const s=e.id;let l=`/frls/review/finance-detail/${s}`;try{typeof route=="function"&&(l=route("frls.review.finance-detail",s))}catch{}const o=await nt.get(l);o.data&&o.data.success&&(g.value=o.data)}catch{}finally{$.value=!1}}},{immediate:!0}),(e,s)=>(i(),J(P,null,{default:y(()=>[v(Q,{icon:"mdiFileEye",title:"Review Details",main:""},{default:y(()=>[v(G,null,{default:y(()=>[v(tt,{icon:"mdiViewList",label:"Back to List",color:"contrast","rounded-full":"",small:"",onClick:V})]),_:1})]),_:1}),v(et,null,{default:y(()=>{var l;return[t("div",it,[t("div",null,[s[1]||(s[1]=t("div",{class:"text-sm font-semibold"},"Site/Location",-1)),t("div",lt,a(((l=u.form.branch)==null?void 0:l.branch_name)??""),1)]),t("div",null,[s[2]||(s[2]=t("div",{class:"text-sm font-semibold"},"Fund Request Reference No.",-1)),t("div",rt,a(u.form.frm_no),1)]),t("div",null,[s[3]||(s[3]=t("div",{class:"text-sm font-semibold"},"Disbursement Reference No.",-1)),t("div",ut,a(u.summary.disbursement_no||""),1)])]),t("div",ct,[s[4]||(s[4]=t("div",{class:"text-sm font-semibold"},"Liquidation Ref No.",-1)),t("div",dt,a(u.summary.liquidation_ref||""),1)]),t("div",mt,[s[7]||(s[7]=t("div",{class:"text-xs text-gray-500 uppercase mb-2"},"Items",-1)),t("div",pt,[t("table",ft,[s[6]||(s[6]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left"},"Account Code"),t("th",{class:"px-4 py-2 text-left"},"Frequency"),t("th",{class:"px-4 py-2 text-left"},"Description"),t("th",{class:"px-4 py-2 text-right"},"Qty"),t("th",{class:"px-4 py-2 text-right"},"Unit Price"),t("th",{class:"px-4 py-2 text-right"},"Amount")])],-1)),t("tbody",null,[(i(!0),r(T,null,R(g.value.items,(o,b)=>(i(),r("tr",{key:b,class:"border-t"},[t("td",vt,a(o.account_code_title),1),t("td",xt,a(o.frequency_label),1),t("td",_t,a(o.description),1),t("td",bt,a(o.qty),1),t("td",ht,a(_(o.unit_price)),1),t("td",yt,a(_(o.amount)),1)]))),128))]),t("tfoot",null,[t("tr",gt,[s[5]||(s[5]=t("td",{colspan:"5",class:"px-4 py-2 text-right font-semibold"},"Total Amount:",-1)),t("td",wt,"₱"+a(_((g.value.items||[]).reduce((o,b)=>o+(parseFloat(b.amount)||0),0))),1)])])])])]),t("div",Dt,[s[9]||(s[9]=t("div",{class:"text-xs text-gray-500 uppercase mb-2"},"Liquidation Details",-1)),t("div",At,[t("table",kt,[s[8]||(s[8]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left"},"Date"),t("th",{class:"px-4 py-2 text-left"},"OR No"),t("th",{class:"px-4 py-2 text-left"},"Description"),t("th",{class:"px-4 py-2 text-right"},"Expense Amount"),t("th",{class:"px-4 py-2 text-right"},"Input VAT"),t("th",{class:"px-4 py-2 text-left"},"Status"),t("th",{class:"px-4 py-2 text-left"},"Receipt")])],-1)),t("tbody",null,[(i(!0),r(T,null,R(g.value.liquidation,o=>(i(),r("tr",{key:o.id,class:"border-t"},[t("td",Ft,a(O(o.date)),1),t("td",qt,a(o.or_no||"—"),1),t("td",Nt,a(o.description||"—"),1),t("td",Lt,"₱"+a(_(o.expense_amount)),1),t("td",$t,a(_(o.input_vat)),1),t("td",Ct,a(o.vat_non_vat||"—"),1),t("td",St,[o.thumbnail_url?(i(),r("div",{key:0,class:"h-16 w-16 overflow-hidden rounded cursor-pointer",onClick:b=>E(o.thumbnail_url)},[t("img",{src:o.thumbnail_url,alt:"",class:"h-16 w-16 object-cover"},null,8,Tt)],8,Mt)):(i(),r("span",Rt,"—"))])]))),128))])])])]),t("div",Bt,[t("div",null,[s[10]||(s[10]=t("span",{class:"font-semibold"},"Disbursed Fund Request:",-1)),t("span",Ot,"₱"+a(m(u.summary.requested_total)),1)]),t("div",null,[s[11]||(s[11]=t("span",{class:"font-semibold"},"Liquidated Expenses:",-1)),t("span",Vt,"₱"+a(m(u.summary.liquidated_total)),1)]),C.value>0?(i(),r("div",Xt,[s[12]||(s[12]=t("span",{class:"font-semibold"},"Balance for Reimbursement:",-1)),t("span",Yt,"₱"+a(m(C.value)),1)])):M("",!0)]),s[13]||(s[13]=t("div",{class:"mt-8 grid grid-cols-1 md:grid-cols-3 gap-6"},[t("div",null,[t("div",null,[t("span",{class:"font-semibold"},"Approved by:"),x(" (Finance Staff)")]),t("div",null,[t("span",{class:"font-semibold"},"Approved Date and Time:"),x(" N/A")])]),t("div",null,[t("div",null,[t("span",{class:"font-semibold"},"Approved by:"),x(" (Finance Manager)")]),t("div",null,[t("span",{class:"font-semibold"},"Approved Date and Time:"),x(" N/A")])]),t("div",null,[t("div",null,[t("span",{class:"font-semibold"},"Approved by:"),x(" (CFO)")]),t("div",null,[t("span",{class:"font-semibold"},"Approved Date and Time:"),x(" N/A")])])],-1))]}),_:1}),v(at,{show:L.value,title:"Liquidation Breakdown",onClose:s[0]||(s[0]=l=>L.value=!1)},{default:y(()=>[v(st,{"table-rows":X.value,"table-header":j,"table-name":"liquidation-breakdown"},null,8,["table-rows"]),t("div",jt,"Total: ₱"+a(m(Y.value)),1)]),_:1},8,["show"]),F.value?(i(),r("div",{key:0,class:"fixed inset-0 z-50 bg-black/80 select-none",onClick:k(S,["self"])},[t("button",{type:"button",class:"absolute top-4 right-4 bg-white/20 hover:bg-white/30 text-white rounded-full h-10 w-10 flex items-center justify-center text-xl",onClick:S},"✕"),t("div",{class:"w-full h-full flex items-center justify-center",onWheel:k(z,["prevent"])},[t("img",{src:q.value,alt:"",class:"object-contain max-w-none",style:K({transform:`translate(${p.value}px, ${f.value}px) scale(${w.value})`,cursor:c.value?"grabbing":"grab"}),onMousedown:I,onMousemove:U,onMouseup:N,onMouseleave:N,onTouchstart:k(H,["prevent"]),onTouchmove:k(W,["prevent"]),onTouchend:N},null,44,Et)],32)])):M("",!0)]),_:1}))}};export{ze as default};
