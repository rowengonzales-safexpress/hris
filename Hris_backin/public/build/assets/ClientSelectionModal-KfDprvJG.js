import{m as y}from"./mini-toastr-ZJ-XgUIA.js";import{_ as N}from"./CoreTable.vue_vue_type_style_index_0_lang-D8LkGZdJ.js";import{_ as h}from"./BaseButton-YqB03AwT.js";import{_ as x}from"./Modal.vue_vue_type_script_setup_true_lang-DpTllPHL.js";import{d as V,b as $,r as a,w as b,o as B,K as T,y as E,J as H,D as o,H as d}from"./@vue-DhfKueGL.js";import{_ as M}from"./app-VaUb3FJr.js";const q={class:"p-6"},K={class:"store-modal-container"},P={class:"store-list-section mb-6"},R={class:"modal-footer"},j=V({__name:"ClientSelectionModal",props:{modelValue:{type:Boolean},selectedStore:{},packageInfo:{},clientId:{}},emits:["update:modelValue","stores-selected"],setup(g,{emit:w}){var _,p,v;const t=g,m=w,s=$({get:()=>t.modelValue,set:e=>m("update:modelValue",e)}),n=a([]),c=a([]),l=a([]);a(t.selectedStore||null),a("");const u=a(!1);a(!1),a(null);const k=a({quantity:((_=t.packageInfo)==null?void 0:_.quantity)||null,weight:((p=t.packageInfo)==null?void 0:p.weight)||null,value:((v=t.packageInfo)==null?void 0:v.value)||null}),S=[{label:"Store Code",fieldName:"store_code"},{label:"Store Name",fieldName:"store_name"},{label:"Client",fieldName:"client_name"},{label:"Email",fieldName:"contact_email"},{label:"Phone",fieldName:"contact_phone"},{label:"City",fieldName:"city"},{label:"Status",fieldName:"is_active",type:"activeinactive"}],f=async()=>{if(console.log("loadStores called with clientId:",t.clientId),!t.clientId){console.log("No clientId provided, clearing stores"),n.value=[],c.value=[];return}u.value=!0;try{const e=await fetch(`/tracking/store/api/by-client/${t.clientId}`,{});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const i=await e.json();n.value=i||[],c.value=n.value}catch{y.error("Error loading stores"),n.value=[],c.value=[]}finally{u.value=!1}},C=e=>{l.value=e||[]},I=()=>{l.value.length>0&&(m("stores-selected",{stores:l.value,packageInfo:k.value}),r())},r=()=>{s.value=!1};return b(s,e=>{e&&t.clientId&&(f(),l.value=[])}),b(()=>t.clientId,e=>{e&&s.value&&(f(),l.value=[])}),B(()=>{t.selectedStore&&(l.value=[t.selectedStore])}),(e,i)=>(E(),T(x,{show:s.value,maxWidth:"2xl",onClose:r},{default:H(()=>[o("div",q,[i[0]||(i[0]=o("h3",{class:"text-lg font-medium leading-6 text-gray-900 dark:text-gray-100 mb-4"},"Select Store",-1)),o("div",K,[o("div",P,[d(N,{"table-rows":c.value,"table-header":S,"table-name":"stores-select","searchable-fields":"store_code,store_name,client_name,city,contact_phone,contact_email,address","is-paginated":!0,"is-show-row-checkbox":!0,"show-total":!1,"show-page-info":!1,"show-download-csv":!1,onCheckRows:C,class:"store-data-table"},null,8,["table-rows"])]),o("div",R,[d(h,{onClick:r,color:"contrast",label:"Cancel",class:"mr-3"}),d(h,{onClick:I,color:"info",disabled:l.value.length===0,label:`OK (${l.value.length} selected)`},null,8,["disabled","label"])])])])]),_:1},8,["show"]))}}),A=M(j,[["__scopeId","data-v-65fcf7e3"]]);export{A as C};
