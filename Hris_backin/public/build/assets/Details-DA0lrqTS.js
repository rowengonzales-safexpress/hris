import{u as M}from"./@inertiajs-DE7H7qLl.js";import{h as N}from"./moment-T1pcntrQ.js";import{a as k}from"./axios-ngrFHoWO.js";import{_ as V}from"./BaseButton-YqB03AwT.js";import{_ as E}from"./BaseButtons--tE85GFf.js";import{_ as n}from"./FormField-Cnx0pd2b.js";import{_ as d}from"./FormControl-C_nPUmK8.js";import{r as v,b as y,w as I,x as u,y as c,D as i,H as a,J as s,F as R,z as $,C,L as p}from"./@vue-DhfKueGL.js";import"./qs-DlAKVIfT.js";import"./side-channel-CCwe-Ttv.js";import"./es-errors-CFxpeikN.js";import"./object-inspect-CiOUnV34.js";import"./call-bind-apply-helpers-zm886y3p.js";import"./function-bind-CHqF18-c.js";import"./side-channel-list-BCqwI4KF.js";import"./side-channel-map-Bo135rTK.js";import"./get-intrinsic-DYXGad5I.js";import"./es-object-atoms-Ditt1eQ6.js";import"./math-intrinsics-Cv-yPkyD.js";import"./gopd-fcd2-aIC.js";import"./es-define-property-bDCdrV83.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-CQl1k7Za.js";import"./dunder-proto-tAQ_MH3o.js";import"./hasown-DwiY0sux.js";import"./call-bound-DTEBmFVe.js";import"./side-channel-weakmap-DvnJlOn0.js";import"./lodash-es-BU332SBD.js";import"./html2pdf.js-p1DVm4cu.js";import"./html2canvas-CBrSDip1.js";import"./BaseIcon-BVVkr6PJ.js";import"./@mdi-Ds8bXjTD.js";import"./pinia-DPcN--oA.js";const A={class:"details-container"},L={class:"details-content"},P={class:"detail-section"},Y={class:"detail-section"},H={key:0,class:"store-table-container overflow-x-auto"},j={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},q={class:"px-4 py-2"},z={key:0,class:"flex flex-col items-center bg-green-200 px-2 py-2 rounded"},G={class:"px-4 py-2"},J={class:"px-4 py-2"},O={class:"px-4 py-2"},W={class:"px-4 py-2"},K={key:0,class:"flex flex-col items-center bg-green-50 px-2 py-2 rounded"},Q={class:"font-semibold text-lg text-green-700"},X={class:"text-xs text-gray-600"},Z={key:1,class:"text-sm text-gray-500"},w={class:"detail-section"},D={class:"detail-section"},ee={class:"flex items-center mb-3"},te=["checked"],le={class:"details-actions"},Ae={__name:"Details",props:{data:{type:Object,required:!0},trackingTypes:{type:Array,default:()=>[]},trackingStatuses:{type:Array,default:()=>[]},isNew:{type:Boolean,default:!1}},emits:["close","save","update","Manage","triggerTopRightButton"],setup(U,{emit:S}){const T=U,f=S,r=M({id:null,branch_id:"",tracking_number:"",reference_number:"",tracking_type_id:"",estimated_delivery_date:"",actual_delivery_date:"",current_status_id:"",current_location:"",priority_level:"",total_weight:"",total_volume:"",package_count:"",special_instructions:"",driver_id:"",helper_name:"",call_time:"",whse_in:"",loading_start:"",loading_end:"",whse_out:"",is_active:!0}),o=v({id:null,warehouse_id:"",tracking_number:"",reference_number:"",tracking_type:"",current_status:"",estimated_delivery_date:"",actual_delivery_date:"",current_location:"",priority_level:"",total_weight:"",total_volume:"",package_count:"",special_instructions:"",driver_id:"",helper_name:"",call_time:"",whse_in:"",loading_start:"",loading_end:"",whse_out:"",is_active:!0}),h=y(()=>o.value.estimated_delivery_date?N(o.value.estimated_delivery_date).format("MMMM DD, YYYY"):"-"),_=v([]);y(()=>o.value.current_location||"-"),v({}),y(()=>{const l={};return _.value.forEach(e=>{const t=e.city||"Unknown";l[t]||(l[t]=[]),e.Plateno&&!l[t].includes(e.Plateno)&&l[t].push(e.Plateno)}),l});const b=y(()=>{const l=[],e=new Map;return _.value.forEach((t,g)=>{const m=t.city||"Unknown";e.has(m)||e.set(m,[]),e.get(m).push({...t,originalIndex:g})}),e.forEach((t,g)=>{t.forEach((m,x)=>{l.push({...m,cityRowspan:x===0?t.length:0,cityCount:t.length,isFirstInCity:x===0})})}),l});I(()=>T.data,l=>{l&&(o.value={...l},r.id=l.id,r.branch_id=l.branch_id||"",r.tracking_number=l.tracking_number||"",r.reference_number=l.reference_number||"",r.tracking_type_id=l.tracking_type_id||"",r.estimated_delivery_date=l.estimated_delivery_date||"",r.actual_delivery_date=l.actual_delivery_date||"",r.current_status_id=l.current_status_id||"",r.current_location=l.current_location||"",r.priority_level=l.priority_level||"",r.total_weight=l.total_weight||"",r.total_volume=l.total_volume||"",r.package_count=l.package_count||"",r.special_instructions=l.special_instructions||"",r.driver_id=l.driver_id||"",r.helper_name=l.helper_name||"",r.call_time=l.call_time||"",r.whse_in=l.whse_in||"",r.loading_start=l.loading_start||"",r.loading_end=l.loading_end||"",r.whse_out=l.whse_out||"",r.is_active=l.is_active!==void 0?l.is_active:!0,l.id?(k.get(`/tracking/tracking-event/header/${l.id}`).then(e=>{const t=e.data||{};o.value={...o.value,...t},r.driver_id=t.driver_id??r.driver_id,r.call_time=t.call_time??r.call_time,r.whse_in=t.whse_in??r.whse_in,r.loading_start=t.loading_start??r.loading_start,r.loading_end=t.loading_end??r.loading_end,r.whse_out=t.whse_out??r.whse_out}).catch(e=>{console.error("Failed loading header details:",e)}),k.get(`/tracking/tracker/api/droptrip-summary/${l.id}`).then(e=>{_.value=e.data||[]}).catch(e=>{console.error("Failed loading droptrip summary:",e),_.value=[]})):_.value=[])},{immediate:!0});const F=()=>{f("close")},B=()=>{f("triggerTopRightButton","Manage",o.value)};return(l,e)=>(c(),u("div",A,[i("div",L,[i("div",P,[a(n,{label:"Trackin Number"},{default:s(()=>[a(d,{readonly:"",name:"tracking_number",modelValue:o.value.tracking_number,"onUpdate:modelValue":e[0]||(e[0]=t=>o.value.tracking_number=t),type:"text"},null,8,["modelValue"])]),_:1}),a(n,{label:"Reference Number"},{default:s(()=>[a(d,{readonly:"",name:"reference_number",modelValue:o.value.reference_number,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.reference_number=t),type:"text"},null,8,["modelValue"])]),_:1}),a(n,{label:"Tracking Type"},{default:s(()=>[a(d,{readonly:"",name:"tracking_type",modelValue:o.value.tracking_type,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.tracking_type=t),type:"text"},null,8,["modelValue"])]),_:1}),a(n,{label:"Current Status"},{default:s(()=>[a(d,{readonly:"",name:"current_status",modelValue:o.value.current_status,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.current_status=t),type:"text"},null,8,["modelValue"])]),_:1})]),i("div",Y,[e[10]||(e[10]=i("h3",{class:"section-title"},"Store Information",-1)),b.value.length>0?(c(),u("div",H,[i("table",j,[e[9]||(e[9]=i("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[i("tr",null,[i("th",{class:"px-4 py-2"},"Trip"),i("th",{class:"px-4 py-2"},"Client"),i("th",{class:"px-4 py-2"},"Consignee/Store"),i("th",{class:"px-4 py-2"},"Address"),i("th",{class:"px-4 py-2"},"Drops")])],-1)),i("tbody",null,[(c(!0),u(R,null,$(b.value,(t,g)=>(c(),u("tr",{key:g,class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[i("td",q,[t.isFirstInCity?(c(),u("div",z,[...e[8]||(e[8]=[i("span",{class:"font-semibold text-lg text-green-800"},"1",-1),i("span",{class:"text-xs text-gray-700"},"TRIP",-1)])])):C("",!0)]),i("td",G,p(t.Client||"-"),1),i("td",J,p(t.ClientStore),1),i("td",O,p(t.Address),1),i("td",W,[t.isFirstInCity?(c(),u("div",K,[i("span",Q,p(t.cityCount),1),i("span",X,p(t.cityCount===1?"drop":"drops"),1)])):C("",!0)])]))),128))])])])):(c(),u("div",Z,"No store information found for this event."))]),i("div",w,[e[11]||(e[11]=i("h3",{class:"section-title"},"Location & Delivery",-1)),a(n,{label:"Current Location"},{default:s(()=>[a(d,{name:"current_location",modelValue:o.value.current_location,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.current_location=t),type:"text"},null,8,["modelValue"])]),_:1}),a(n,{label:"Priority Level"},{default:s(()=>[a(d,{name:"priority_level",modelValue:o.value.priority_level,"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.priority_level=t),type:"text"},null,8,["modelValue"])]),_:1}),a(n,{label:"Total Weight"},{default:s(()=>[a(d,{readonly:"",name:"total_weight",modelValue:h.value,"onUpdate:modelValue":e[6]||(e[6]=t=>h.value=t),type:"text"},null,8,["modelValue"])]),_:1})]),a(n,{label:"Special Instructions"},{default:s(()=>[a(d,{name:"special_instructions",modelValue:o.value.special_instructions,"onUpdate:modelValue":e[7]||(e[7]=t=>o.value.special_instructions=t),type:"textarea"},null,8,["modelValue"])]),_:1}),i("div",D,[e[13]||(e[13]=i("h3",{class:"section-title"},"Status",-1)),i("div",ee,[i("input",{type:"checkbox",checked:o.value.is_active,disabled:"",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,8,te),e[12]||(e[12]=i("label",{class:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-300"},"Active",-1))])])]),i("div",le,[a(E,null,{default:s(()=>[a(V,{icon:"mdinav",color:"info","rounded-full":"",small:"",label:"manage",onClick:B}),a(V,{icon:"mdiClose",color:"danger","rounded-full":"",small:"",label:"Cancel",onClick:F})]),_:1})])]))}};export{Ae as default};
